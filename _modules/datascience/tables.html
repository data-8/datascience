
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>datascience.tables &#8212; datascience 0.15.7 documentation</title>
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">datascience 0.15.7 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">datascience.tables</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for datascience.tables</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Tables are sequences of labeled columns.&quot;&quot;&quot;</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Table&#39;</span><span class="p">]</span>

<span class="kn">import</span> <span class="nn">abc</span>
<span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">collections.abc</span>
<span class="kn">import</span> <span class="nn">functools</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">numbers</span>
<span class="kn">import</span> <span class="nn">urllib.parse</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;agg&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="kn">import</span> <span class="nn">IPython</span>

<span class="kn">import</span> <span class="nn">datascience.formats</span> <span class="k">as</span> <span class="nn">_formats</span>
<span class="kn">import</span> <span class="nn">datascience.util</span> <span class="k">as</span> <span class="nn">_util</span>
<span class="kn">from</span> <span class="nn">datascience.util</span> <span class="kn">import</span> <span class="n">make_array</span>
<span class="kn">import</span> <span class="nn">datascience.predicates</span> <span class="k">as</span> <span class="nn">_predicates</span>

<span class="k">class</span> <span class="nc">Table</span><span class="p">(</span><span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A sequence of string-labeled columns.&quot;&quot;&quot;</span>
    <span class="n">plots</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<div class="viewcode-block" id="Table.__init__"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.__init__.html#datascience.tables.Table.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">formatter</span><span class="o">=</span><span class="n">_formats</span><span class="o">.</span><span class="n">default_formatter</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create an empty table with column labels.</span>

<span class="sd">        &gt;&gt;&gt; tiles = Table(make_array(&#39;letter&#39;, &#39;count&#39;, &#39;points&#39;))</span>
<span class="sd">        &gt;&gt;&gt; tiles</span>
<span class="sd">        letter | count | points</span>

<span class="sd">        Args:</span>
<span class="sd">            ``labels`` (list of strings): The column labels.</span>

<span class="sd">            ``formatter`` (Formatter): An instance of :class:`Formatter` that</span>
<span class="sd">                formats the columns&#39; values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_formats</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formatter</span> <span class="o">=</span> <span class="n">formatter</span>
        
        <span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span> <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_num_rows</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span> <span class="ow">is</span> <span class="mi">0</span> <span class="k">else</span> <span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="c1"># Add each column to table</span>
        <span class="k">for</span> <span class="n">column</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">column</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">take</span> <span class="o">=</span> <span class="n">_RowTaker</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exclude</span> <span class="o">=</span> <span class="n">_RowExcluder</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

    <span class="c1"># Deprecated</span>
<div class="viewcode-block" id="Table.empty"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.empty.html#datascience.tables.Table.empty">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">empty</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates an empty table. Column labels are optional. [Deprecated]</span>

<span class="sd">        Args:</span>
<span class="sd">            ``labels`` (None or list): If ``None``, a table with 0</span>
<span class="sd">                columns is created.</span>
<span class="sd">                If a list, each element is a column label in a table with</span>
<span class="sd">                0 rows.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A new instance of ``Table``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Table.empty(labels) is deprecated. Use Table(labels)&quot;</span><span class="p">,</span> <span class="ne">FutureWarning</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="p">()</span>
        <span class="n">values</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span></div>

    <span class="c1"># Deprecated</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_rows</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a table from a sequence of rows (fixed-length sequences). [Deprecated]&quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Table.from_rows is deprecated. Use Table(labels).with_rows(...)&quot;</span><span class="p">,</span> <span class="ne">FutureWarning</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span><span class="o">.</span><span class="n">with_rows</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>

<div class="viewcode-block" id="Table.from_records"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.from_records.html#datascience.tables.Table.from_records">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_records</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">records</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a table from a sequence of records (dicts with fixed keys).&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">records</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="p">()</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">records</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="p">[[</span><span class="n">rec</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">records</span><span class="p">]</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">()</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">columns</span><span class="p">))</span></div>

    <span class="c1"># Deprecated</span>
<div class="viewcode-block" id="Table.from_columns_dict"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.from_columns_dict.html#datascience.tables.Table.from_columns_dict">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_columns_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">columns</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a table from a mapping of column labels to column values. [Deprecated]&quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Table.from_columns_dict is deprecated. Use Table().with_columns(...)&quot;</span><span class="p">,</span> <span class="ne">FutureWarning</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">()</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">columns</span><span class="o">.</span><span class="n">items</span><span class="p">())</span></div>

<div class="viewcode-block" id="Table.read_table"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.read_table.html#datascience.tables.Table.read_table">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">read_table</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">vargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read a table from a file or web address.</span>

<span class="sd">        filepath_or_buffer -- string or file handle / StringIO; The string</span>
<span class="sd">                              could be a URL. Valid URL schemes include http,</span>
<span class="sd">                              ftp, s3, and file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Look for .csv at the end of the path; use &quot;,&quot; as a separator if found</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlparse</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">)</span><span class="o">.</span><span class="n">path</span>
            <span class="k">if</span> <span class="s1">&#39;data8.berkeley.edu&#39;</span> <span class="ow">in</span> <span class="n">filepath_or_buffer</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data8.berkeley.edu requires authentication, &#39;</span>
                                 <span class="s1">&#39;which is not supported.&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">filepath_or_buffer</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;sep&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">vargs</span> <span class="ow">and</span> <span class="n">path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.csv&#39;</span><span class="p">):</span>
                <span class="n">vargs</span><span class="p">[</span><span class="s1">&#39;sep&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">vargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_df</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_with_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">columns</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a table from a sequence of columns, copying column labels.&quot;&quot;&quot;</span>
        <span class="n">table</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)()</span>
        <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="n">columns</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_column_and_format</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">column</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">table</span>

    <span class="k">def</span> <span class="nf">_add_column_and_format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">column</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a column to table, copying the formatter from self.&quot;&quot;&quot;</span>
        <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_as_label</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="n">table</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">column</span>
        <span class="k">if</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_formats</span><span class="p">:</span>
            <span class="n">table</span><span class="o">.</span><span class="n">_formats</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_formats</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>

<div class="viewcode-block" id="Table.from_df"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.from_df.html#datascience.tables.Table.from_df">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_df</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">keep_index</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert a Pandas DataFrame into a Table.</span>

<span class="sd">        `keep_index` -- keeps the index of the DataFrame </span>
<span class="sd">            and turns it into a column called `index` in </span>
<span class="sd">            the new Table</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">keep_index</span><span class="p">:</span>
            <span class="n">t</span><span class="o">.</span><span class="n">append_column</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span>
        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>
            <span class="n">t</span><span class="o">.</span><span class="n">append_column</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="n">label</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">t</span></div>

<div class="viewcode-block" id="Table.from_array"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.from_array.html#datascience.tables.Table.from_array">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_array</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">arr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert a structured NumPy array into a Table.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">()</span><span class="o">.</span><span class="n">with_columns</span><span class="p">([(</span><span class="n">f</span><span class="p">,</span> <span class="n">arr</span><span class="p">[</span><span class="n">f</span><span class="p">])</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">arr</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">])</span></div>

    <span class="c1">#################</span>
    <span class="c1"># Magic Methods #</span>
    <span class="c1">#################</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index_or_label</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">index_or_label</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index_or_label</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">append_column</span><span class="p">(</span><span class="n">index_or_label</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index_or_label</span><span class="p">):</span>
        <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_as_label</span><span class="p">(</span><span class="n">index_or_label</span><span class="p">)</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_formats</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_formats</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">)</span>

    <span class="c1"># Deprecated</span>
    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a method that applies to all columns or a table of attributes. [Deprecated]</span>

<span class="sd">        E.g., t.sum() on a Table will return a table with the sum of each column.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Implicit column method lookup is deprecated.&quot;</span><span class="p">,</span> <span class="ne">FutureWarning</span><span class="p">)</span>
            <span class="n">attrs</span> <span class="o">=</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">callable</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span> <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">attrs</span><span class="p">):</span>
                <span class="nd">@functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">attrs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">def</span> <span class="nf">method</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">vargs</span><span class="p">):</span>
                    <span class="sd">&quot;&quot;&quot;Create a table from the results of calling attrs.&quot;&quot;&quot;</span>
                    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">attr</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">vargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">attrs</span><span class="p">]</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_with_columns</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">method</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_with_columns</span><span class="p">([[</span><span class="n">attr</span><span class="p">]</span> <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">attrs</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;&#39;</span><span class="si">{0}</span><span class="s2">&#39; object has no attribute &#39;</span><span class="si">{1}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="c1">####################</span>
    <span class="c1"># Accessing Values #</span>
    <span class="c1">####################</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">num_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Number of rows.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_rows</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">rows</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a view of all rows.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Rows</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<div class="viewcode-block" id="Table.row"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.row.html#datascience.tables.Table.row">[docs]</a>    <span class="k">def</span> <span class="nf">row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a row.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="n">index</span><span class="p">]</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">labels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a tuple of column labels.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="c1"># Deprecated</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">column_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a tuple of column labels. [Deprecated]&quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;column_labels is deprecated; use labels&quot;</span><span class="p">,</span> <span class="ne">FutureWarning</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">num_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Number of columns.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">columns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a tuple of columns, each with the values in that column.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

<div class="viewcode-block" id="Table.column"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.column.html#datascience.tables.Table.column">[docs]</a>    <span class="k">def</span> <span class="nf">column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index_or_label</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the values of a column as an array.</span>

<span class="sd">        table.column(label) is equivalent to table[label].</span>

<span class="sd">        &gt;&gt;&gt; tiles = Table().with_columns(</span>
<span class="sd">        ...     &#39;letter&#39;, make_array(&#39;c&#39;, &#39;d&#39;),</span>
<span class="sd">        ...     &#39;count&#39;,  make_array(2, 4),</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; list(tiles.column(&#39;letter&#39;))</span>
<span class="sd">        [&#39;c&#39;, &#39;d&#39;]</span>
<span class="sd">        &gt;&gt;&gt; tiles.column(1)</span>
<span class="sd">        array([2, 4])</span>

<span class="sd">        Args:</span>
<span class="sd">            label (int or str): The index or label of a column</span>

<span class="sd">        Returns:</span>
<span class="sd">            An instance of ``numpy.array``.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ``ValueError``: When the ``index_or_label`` is not in the table.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">index_or_label</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
                <span class="ow">and</span> <span class="n">index_or_label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;The column &quot;</span><span class="si">{}</span><span class="s1">&quot; is not in the table. The table contains &#39;</span>
                <span class="s1">&#39;these columns: </span><span class="si">{}</span><span class="s1">&#39;</span>
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">index_or_label</span><span class="p">,</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">))</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">index_or_label</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
                <span class="ow">and</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">index_or_label</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;The index </span><span class="si">{}</span><span class="s1"> is not in the table. Only indices between &#39;</span>
                <span class="s1">&#39;0 and </span><span class="si">{}</span><span class="s1"> are valid&#39;</span>
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">index_or_label</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_as_label</span><span class="p">(</span><span class="n">index_or_label</span><span class="p">)]</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return data in `self` as a numpy array.</span>

<span class="sd">        If all columns are the same dtype, the resulting array</span>
<span class="sd">        will have this dtype. If there are &gt;1 dtypes in columns,</span>
<span class="sd">        then the resulting array will have dtype `object`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span><span class="o">.</span><span class="n">dtype</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">dtypes</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="nb">object</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>

<div class="viewcode-block" id="Table.column_index"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.column_index.html#datascience.tables.Table.column_index">[docs]</a>    <span class="k">def</span> <span class="nf">column_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the index of a column by looking up its label.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">label</span><span class="p">)</span></div>

<div class="viewcode-block" id="Table.apply"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.apply.html#datascience.tables.Table.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="o">*</span><span class="n">column_or_columns</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply ``fn`` to each element or elements of ``column_or_columns``.</span>
<span class="sd">        If no ``column_or_columns`` provided, `fn`` is applied to each row.</span>

<span class="sd">        Args:</span>
<span class="sd">            ``fn`` (function) -- The function to apply to each element</span>
<span class="sd">                of ``column_or_columns``.</span>
<span class="sd">            ``column_or_columns`` -- Columns containing the arguments to ``fn``</span>
<span class="sd">                as either column labels (``str``) or column indices (``int``).</span>
<span class="sd">                The number of columns must match the number of arguments</span>
<span class="sd">                that ``fn`` expects.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ``ValueError`` -- if  ``column_label`` is not an existing</span>
<span class="sd">                column in the table.</span>
<span class="sd">            ``TypeError`` -- if insufficent number of ``column_label`` passed</span>
<span class="sd">                to ``fn``.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An array consisting of results of applying ``fn`` to elements</span>
<span class="sd">            specified by ``column_label`` in each row.</span>

<span class="sd">        &gt;&gt;&gt; t = Table().with_columns(</span>
<span class="sd">        ...     &#39;letter&#39;, make_array(&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;z&#39;),</span>
<span class="sd">        ...     &#39;count&#39;,  make_array(9, 3, 3, 1),</span>
<span class="sd">        ...     &#39;points&#39;, make_array(1, 2, 2, 10))</span>
<span class="sd">        &gt;&gt;&gt; t</span>
<span class="sd">        letter | count | points</span>
<span class="sd">        a      | 9     | 1</span>
<span class="sd">        b      | 3     | 2</span>
<span class="sd">        c      | 3     | 2</span>
<span class="sd">        z      | 1     | 10</span>
<span class="sd">        &gt;&gt;&gt; t.apply(lambda x: x - 1, &#39;points&#39;)</span>
<span class="sd">        array([0, 1, 1, 9])</span>
<span class="sd">        &gt;&gt;&gt; t.apply(lambda x, y: x * y, &#39;count&#39;, &#39;points&#39;)</span>
<span class="sd">        array([ 9,  6,  6, 10])</span>
<span class="sd">        &gt;&gt;&gt; t.apply(lambda x: x - 1, &#39;count&#39;, &#39;points&#39;)</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        TypeError: &lt;lambda&gt;() takes 1 positional argument but 2 were given</span>
<span class="sd">        &gt;&gt;&gt; t.apply(lambda x: x - 1, &#39;counts&#39;)</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        ValueError: The column &quot;counts&quot; is not in the table. The table contains these columns: letter, count, points</span>

<span class="sd">        Whole rows are passed to the function if no columns are specified.</span>

<span class="sd">        &gt;&gt;&gt; t.apply(lambda row: row[1] * 2)</span>
<span class="sd">        array([18,  6,  6,  2])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">column_or_columns</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">fn</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">column_or_columns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> \
                    <span class="n">_is_non_string_iterable</span><span class="p">(</span><span class="n">column_or_columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                   <span class="s2">&quot;column lists are deprecated; pass each as an argument&quot;</span><span class="p">,</span> <span class="ne">FutureWarning</span><span class="p">)</span>
                <span class="n">column_or_columns</span> <span class="o">=</span> <span class="n">column_or_columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="o">*</span><span class="n">column_or_columns</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">fn</span><span class="p">(</span><span class="o">*</span><span class="n">row</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">])</span></div>

<div class="viewcode-block" id="Table.first"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.first.html#datascience.tables.Table.first">[docs]</a>    <span class="k">def</span> <span class="nf">first</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the zeroth item in a column.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">label</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="Table.last"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.last.html#datascience.tables.Table.last">[docs]</a>    <span class="k">def</span> <span class="nf">last</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the last item in a column.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">label</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span></div>

    <span class="c1">############</span>
    <span class="c1"># Mutation #</span>
    <span class="c1">############</span>

<div class="viewcode-block" id="Table.set_format"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.set_format.html#datascience.tables.Table.set_format">[docs]</a>    <span class="k">def</span> <span class="nf">set_format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_or_columns</span><span class="p">,</span> <span class="n">formatter</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the format of a column.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">(</span><span class="n">formatter</span><span class="p">):</span>
            <span class="n">formatter</span> <span class="o">=</span> <span class="n">formatter</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">formatter</span><span class="p">,</span> <span class="s1">&#39;format_column&#39;</span><span class="p">):</span>
            <span class="n">formatter</span> <span class="o">=</span> <span class="n">_formats</span><span class="o">.</span><span class="n">FunctionFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">formatter</span><span class="p">,</span> <span class="s1">&#39;format_column&#39;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Expected Formatter or function: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">formatter</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_as_labels</span><span class="p">(</span><span class="n">column_or_columns</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">formatter</span><span class="o">.</span><span class="n">converts_values</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">formatter</span><span class="o">.</span><span class="n">convert_column</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">label</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_formats</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">formatter</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Table.move_to_start"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.move_to_start.html#datascience.tables.Table.move_to_start">[docs]</a>    <span class="k">def</span> <span class="nf">move_to_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_label</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Move a column to the first in order.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="o">.</span><span class="n">move_to_end</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_as_label</span><span class="p">(</span><span class="n">column_label</span><span class="p">),</span> <span class="n">last</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Table.move_to_end"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.move_to_end.html#datascience.tables.Table.move_to_end">[docs]</a>    <span class="k">def</span> <span class="nf">move_to_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_label</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Move a column to the last in order.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="o">.</span><span class="n">move_to_end</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_as_label</span><span class="p">(</span><span class="n">column_label</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Table.append"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.append.html#datascience.tables.Table.append">[docs]</a>    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row_or_table</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Append a row or all rows of a table. An appended table must have all</span>
<span class="sd">        columns of self.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">row_or_table</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="n">row_or_table</span> <span class="o">=</span> <span class="n">row_or_table</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">row_or_table</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">row_or_table</span><span class="p">,</span> <span class="n">Table</span><span class="p">):</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">row_or_table</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">)</span><span class="o">.</span><span class="n">_columns</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">num_rows</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">row_or_table</span><span class="p">))</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_columns</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Row should have &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_columns</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; columns&quot;</span><span class="p">)</span>
            <span class="n">columns</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="p">[[</span><span class="n">value</span><span class="p">]</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">row_or_table</span><span class="p">],</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_rows</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">column</span><span class="p">],</span> <span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_num_rows</span> <span class="o">+=</span> <span class="n">n</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Table.append_column"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.append_column.html#datascience.tables.Table.append_column">[docs]</a>    <span class="k">def</span> <span class="nf">append_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">formatter</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Appends a column to the table or replaces a column.</span>

<span class="sd">        ``__setitem__`` is aliased to this method:</span>
<span class="sd">            ``table.append_column(&#39;new_col&#39;, make_array(1, 2, 3))`` is equivalent to</span>
<span class="sd">            ``table[&#39;new_col&#39;] = make_array(1, 2, 3)``.</span>

<span class="sd">        Args:</span>
<span class="sd">            ``label`` (str): The label of the new column.</span>

<span class="sd">            ``values`` (single value or list/array): If a single value, every</span>
<span class="sd">                value in the new column is ``values``.</span>

<span class="sd">                If a list or array, the new column contains the values in</span>
<span class="sd">                ``values``, which must be the same length as the table.</span>
<span class="sd">            ``formatter`` (single formatter): Adds a formatter to the column being </span>
<span class="sd">                appended. No formatter added by default.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Original table with new or replaced column</span>

<span class="sd">        Raises:</span>
<span class="sd">            ``ValueError``: If</span>
<span class="sd">                - ``label`` is not a string.</span>
<span class="sd">                - ``values`` is a list/array and does not have the same length</span>
<span class="sd">                  as the number of rows in the table.</span>

<span class="sd">        &gt;&gt;&gt; table = Table().with_columns(</span>
<span class="sd">        ...     &#39;letter&#39;, make_array(&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;z&#39;),</span>
<span class="sd">        ...     &#39;count&#39;,  make_array(9, 3, 3, 1),</span>
<span class="sd">        ...     &#39;points&#39;, make_array(1, 2, 2, 10))</span>
<span class="sd">        &gt;&gt;&gt; table</span>
<span class="sd">        letter | count | points</span>
<span class="sd">        a      | 9     | 1</span>
<span class="sd">        b      | 3     | 2</span>
<span class="sd">        c      | 3     | 2</span>
<span class="sd">        z      | 1     | 10</span>
<span class="sd">        &gt;&gt;&gt; table.append_column(&#39;new_col1&#39;, make_array(10, 20, 30, 40))</span>
<span class="sd">        letter | count | points | new_col1</span>
<span class="sd">        a      | 9     | 1      | 10</span>
<span class="sd">        b      | 3     | 2      | 20</span>
<span class="sd">        c      | 3     | 2      | 30</span>
<span class="sd">        z      | 1     | 10     | 40</span>
<span class="sd">        &gt;&gt;&gt; table.append_column(&#39;new_col2&#39;, &#39;hello&#39;)</span>
<span class="sd">        letter | count | points | new_col1 | new_col2</span>
<span class="sd">        a      | 9     | 1      | 10       | hello</span>
<span class="sd">        b      | 3     | 2      | 20       | hello</span>
<span class="sd">        c      | 3     | 2      | 30       | hello</span>
<span class="sd">        z      | 1     | 10     | 40       | hello</span>
<span class="sd">        &gt;&gt;&gt; table.append_column(123, make_array(1, 2, 3, 4))</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        ValueError: The column label must be a string, but a int was given</span>
<span class="sd">        &gt;&gt;&gt; table.append_column(&#39;bad_col&#39;, [1, 2])</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        ValueError: Column length mismatch. New column does not have the same number of rows as table.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO(sam): Allow append_column to take in a another table, copying</span>
        <span class="c1"># over formatter as needed.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;The column label must be a string, but a &#39;</span>
                <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> was given&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">label</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="c1"># Coerce a single value to a sequence</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">_is_non_string_iterable</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
                <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">values</span><span class="p">]</span> <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">values</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_rows</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_rows</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Column length mismatch. New column does not have &#39;</span>
                             <span class="s1">&#39;the same number of rows as table.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_num_rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">formatter</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_format</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">formatter</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Table.relabel"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.relabel.html#datascience.tables.Table.relabel">[docs]</a>    <span class="k">def</span> <span class="nf">relabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_label</span><span class="p">,</span> <span class="n">new_label</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Changes the label(s) of column(s) specified by ``column_label`` to</span>
<span class="sd">        labels in ``new_label``.</span>

<span class="sd">        Args:</span>
<span class="sd">            ``column_label`` -- (single str or array of str) The label(s) of</span>
<span class="sd">                columns to be changed to ``new_label``.</span>

<span class="sd">            ``new_label`` -- (single str or array of str): The label name(s)</span>
<span class="sd">                of columns to replace ``column_label``.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ``ValueError`` -- if ``column_label`` is not in table, or if</span>
<span class="sd">                ``column_label`` and ``new_label`` are not of equal length.</span>
<span class="sd">            ``TypeError`` -- if ``column_label`` and/or ``new_label`` is not</span>
<span class="sd">                ``str``.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Original table with ``new_label`` in place of ``column_label``.</span>

<span class="sd">        &gt;&gt;&gt; table = Table().with_columns(</span>
<span class="sd">        ...     &#39;points&#39;, make_array(1, 2, 3),</span>
<span class="sd">        ...     &#39;id&#39;,     make_array(12345, 123, 5123))</span>
<span class="sd">        &gt;&gt;&gt; table.relabel(&#39;id&#39;, &#39;yolo&#39;)</span>
<span class="sd">        points | yolo</span>
<span class="sd">        1      | 12345</span>
<span class="sd">        2      | 123</span>
<span class="sd">        3      | 5123</span>
<span class="sd">        &gt;&gt;&gt; table.relabel(make_array(&#39;points&#39;, &#39;yolo&#39;),</span>
<span class="sd">        ...   make_array(&#39;red&#39;, &#39;blue&#39;))</span>
<span class="sd">        red  | blue</span>
<span class="sd">        1    | 12345</span>
<span class="sd">        2    | 123</span>
<span class="sd">        3    | 5123</span>
<span class="sd">        &gt;&gt;&gt; table.relabel(make_array(&#39;red&#39;, &#39;green&#39;, &#39;blue&#39;),</span>
<span class="sd">        ...   make_array(&#39;cyan&#39;, &#39;magenta&#39;, &#39;yellow&#39;, &#39;key&#39;))</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        ValueError: Invalid arguments. column_label and new_label must be of equal length.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">column_label</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">):</span>
            <span class="n">column_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_as_label</span><span class="p">(</span><span class="n">column_label</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">column_label</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_label</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">column_label</span><span class="p">,</span> <span class="n">new_label</span> <span class="o">=</span> <span class="p">[</span><span class="n">column_label</span><span class="p">],</span> <span class="p">[</span><span class="n">new_label</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">column_label</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_label</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid arguments. column_label and new_label &#39;</span>
                <span class="s1">&#39;must be of equal length.&#39;</span><span class="p">)</span>
        <span class="n">old_to_new</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">column_label</span><span class="p">,</span> <span class="n">new_label</span><span class="p">))</span> <span class="c1"># maps old labels to new ones</span>
        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">column_label</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid labels. Column labels must &#39;</span>
                <span class="s1">&#39;already exist in table in order to be replaced.&#39;</span><span class="p">)</span>
        <span class="n">rewrite</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">old_to_new</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">old_to_new</span> <span class="k">else</span> <span class="n">s</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="p">[(</span><span class="n">rewrite</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">column_label</span><span class="p">:</span>
            <span class="c1"># TODO(denero) Error when old and new columns share a name</span>
            <span class="k">if</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_formats</span><span class="p">:</span>
                <span class="n">formatter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_formats</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_formats</span><span class="p">[</span><span class="n">old_to_new</span><span class="p">[</span><span class="n">label</span><span class="p">]]</span> <span class="o">=</span> <span class="n">formatter</span>
                
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Table.remove"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.remove.html#datascience.tables.Table.remove">[docs]</a>    <span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row_or_row_indices</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Removes a row or multiple rows of a table in place.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">row_or_row_indices</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">row_or_row_indices</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">row_or_row_indices</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">rows_remove</span> <span class="o">=</span> <span class="p">[</span><span class="n">row_or_row_indices</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rows_remove</span> <span class="o">=</span> <span class="n">row_or_row_indices</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">elem</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">elem</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">])</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">rows_remove</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_num_rows</span> <span class="o">-=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rows_remove</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>


    <span class="c1">##################</span>
    <span class="c1"># Transformation #</span>
    <span class="c1">##################</span>

<div class="viewcode-block" id="Table.copy"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.copy.html#datascience.tables.Table.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">shallow</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a copy of a table.&quot;&quot;&quot;</span>
        <span class="n">table</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)()</span>
        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">shallow</span><span class="p">:</span>
                <span class="n">column</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">column</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">label</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_column_and_format</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">column</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">table</span></div>

<div class="viewcode-block" id="Table.select"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.select.html#datascience.tables.Table.select">[docs]</a>    <span class="k">def</span> <span class="nf">select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">column_or_columns</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a table with only the columns in ``column_or_columns``.</span>

<span class="sd">        Args:</span>
<span class="sd">            ``column_or_columns``: Columns to select from the ``Table`` as</span>
<span class="sd">            either column labels (``str``) or column indices (``int``).</span>

<span class="sd">        Returns:</span>
<span class="sd">            A new instance of ``Table`` containing only selected columns.</span>
<span class="sd">            The columns of the new ``Table`` are in the order given in</span>
<span class="sd">            ``column_or_columns``.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ``KeyError`` if any of ``column_or_columns`` are not in the table.</span>

<span class="sd">        &gt;&gt;&gt; flowers = Table().with_columns(</span>
<span class="sd">        ...     &#39;Number of petals&#39;, make_array(8, 34, 5),</span>
<span class="sd">        ...     &#39;Name&#39;, make_array(&#39;lotus&#39;, &#39;sunflower&#39;, &#39;rose&#39;),</span>
<span class="sd">        ...     &#39;Weight&#39;, make_array(10, 5, 6)</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; flowers</span>
<span class="sd">        Number of petals | Name      | Weight</span>
<span class="sd">        8                | lotus     | 10</span>
<span class="sd">        34               | sunflower | 5</span>
<span class="sd">        5                | rose      | 6</span>

<span class="sd">        &gt;&gt;&gt; flowers.select(&#39;Number of petals&#39;, &#39;Weight&#39;)</span>
<span class="sd">        Number of petals | Weight</span>
<span class="sd">        8                | 10</span>
<span class="sd">        34               | 5</span>
<span class="sd">        5                | 6</span>

<span class="sd">        &gt;&gt;&gt; flowers  # original table unchanged</span>
<span class="sd">        Number of petals | Name      | Weight</span>
<span class="sd">        8                | lotus     | 10</span>
<span class="sd">        34               | sunflower | 5</span>
<span class="sd">        5                | rose      | 6</span>

<span class="sd">        &gt;&gt;&gt; flowers.select(0, 2)</span>
<span class="sd">        Number of petals | Weight</span>
<span class="sd">        8                | 10</span>
<span class="sd">        34               | 5</span>
<span class="sd">        5                | 6</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_varargs_as_labels</span><span class="p">(</span><span class="n">column_or_columns</span><span class="p">)</span>
        <span class="n">table</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)()</span>
        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_column_and_format</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">label</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">table</span></div>

    <span class="c1"># These, along with a snippet below, are necessary for Sphinx to</span>
    <span class="c1"># correctly load the `take` and `exclude` docstrings.  The definitions</span>
    <span class="c1"># will be over-ridden during class instantiation.</span>
<div class="viewcode-block" id="Table.take"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.take.html#datascience.tables.Table.take">[docs]</a>    <span class="k">def</span> <span class="nf">take</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div>

<div class="viewcode-block" id="Table.exclude"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.exclude.html#datascience.tables.Table.exclude">[docs]</a>    <span class="k">def</span> <span class="nf">exclude</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div>

<div class="viewcode-block" id="Table.drop"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.drop.html#datascience.tables.Table.drop">[docs]</a>    <span class="k">def</span> <span class="nf">drop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">column_or_columns</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a Table with only columns other than selected label or</span>
<span class="sd">        labels.</span>

<span class="sd">        Args:</span>
<span class="sd">            ``column_or_columns`` (string or list of strings): The header</span>
<span class="sd">            names or indices of the columns to be dropped.</span>

<span class="sd">            ``column_or_columns`` must be an existing header name, or a</span>
<span class="sd">            valid column index.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An instance of ``Table`` with given columns removed.</span>

<span class="sd">        &gt;&gt;&gt; t = Table().with_columns(</span>
<span class="sd">        ...     &#39;burgers&#39;,  make_array(&#39;cheeseburger&#39;, &#39;hamburger&#39;, &#39;veggie burger&#39;),</span>
<span class="sd">        ...     &#39;prices&#39;,   make_array(6, 5, 5),</span>
<span class="sd">        ...     &#39;calories&#39;, make_array(743, 651, 582))</span>
<span class="sd">        &gt;&gt;&gt; t</span>
<span class="sd">        burgers       | prices | calories</span>
<span class="sd">        cheeseburger  | 6      | 743</span>
<span class="sd">        hamburger     | 5      | 651</span>
<span class="sd">        veggie burger | 5      | 582</span>
<span class="sd">        &gt;&gt;&gt; t.drop(&#39;prices&#39;)</span>
<span class="sd">        burgers       | calories</span>
<span class="sd">        cheeseburger  | 743</span>
<span class="sd">        hamburger     | 651</span>
<span class="sd">        veggie burger | 582</span>
<span class="sd">        &gt;&gt;&gt; t.drop([&#39;burgers&#39;, &#39;calories&#39;])</span>
<span class="sd">        prices</span>
<span class="sd">        6</span>
<span class="sd">        5</span>
<span class="sd">        5</span>
<span class="sd">        &gt;&gt;&gt; t.drop(&#39;burgers&#39;, &#39;calories&#39;)</span>
<span class="sd">        prices</span>
<span class="sd">        6</span>
<span class="sd">        5</span>
<span class="sd">        5</span>
<span class="sd">        &gt;&gt;&gt; t.drop([0, 2])</span>
<span class="sd">        prices</span>
<span class="sd">        6</span>
<span class="sd">        5</span>
<span class="sd">        5</span>
<span class="sd">        &gt;&gt;&gt; t.drop(0, 2)</span>
<span class="sd">        prices</span>
<span class="sd">        6</span>
<span class="sd">        5</span>
<span class="sd">        5</span>
<span class="sd">        &gt;&gt;&gt; t.drop(1)</span>
<span class="sd">        burgers       | calories</span>
<span class="sd">        cheeseburger  | 743</span>
<span class="sd">        hamburger     | 651</span>
<span class="sd">        veggie burger | 582</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">exclude</span> <span class="o">=</span> <span class="n">_varargs_labels_as_list</span><span class="p">(</span><span class="n">column_or_columns</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="n">c</span> <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude</span> <span class="ow">and</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude</span><span class="p">])</span></div>

<div class="viewcode-block" id="Table.where"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.where.html#datascience.tables.Table.where">[docs]</a>    <span class="k">def</span> <span class="nf">where</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_or_label</span><span class="p">,</span> <span class="n">value_or_predicate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">other</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new ``Table`` containing rows where ``value_or_predicate``</span>
<span class="sd">        returns True for values in ``column_or_label``.</span>

<span class="sd">        Args:</span>
<span class="sd">            ``column_or_label``: A column of the ``Table`` either as a label</span>
<span class="sd">            (``str``) or an index (``int``). Can also be an array of booleans;</span>
<span class="sd">            only the rows where the array value is ``True`` are kept.</span>

<span class="sd">            ``value_or_predicate``: If a function, it is applied to every value</span>
<span class="sd">            in ``column_or_label``. Only the rows where ``value_or_predicate``</span>
<span class="sd">            returns True are kept. If a single value, only the rows where the</span>
<span class="sd">            values in ``column_or_label`` are equal to ``value_or_predicate``</span>
<span class="sd">            are kept.</span>

<span class="sd">            ``other``: Optional additional column label for</span>
<span class="sd">            ``value_or_predicate`` to make pairwise comparisons. See the</span>
<span class="sd">            examples below for usage. When ``other`` is supplied,</span>
<span class="sd">            ``value_or_predicate`` must be a callable function.</span>

<span class="sd">        Returns:</span>
<span class="sd">            If ``value_or_predicate`` is a function, returns a new ``Table``</span>
<span class="sd">            containing only the rows where ``value_or_predicate(val)`` is True</span>
<span class="sd">            for the ``val``s in ``column_or_label``.</span>

<span class="sd">            If ``value_or_predicate`` is a value, returns a new ``Table``</span>
<span class="sd">            containing only the rows where the values in ``column_or_label``</span>
<span class="sd">            are equal to ``value_or_predicate``.</span>

<span class="sd">            If ``column_or_label`` is an array of booleans, returns a new</span>
<span class="sd">            ``Table`` containing only the rows where ``column_or_label`` is</span>
<span class="sd">            ``True``.</span>

<span class="sd">        &gt;&gt;&gt; marbles = Table().with_columns(</span>
<span class="sd">        ...    &quot;Color&quot;, make_array(&quot;Red&quot;, &quot;Green&quot;, &quot;Blue&quot;,</span>
<span class="sd">        ...                        &quot;Red&quot;, &quot;Green&quot;, &quot;Green&quot;),</span>
<span class="sd">        ...    &quot;Shape&quot;, make_array(&quot;Round&quot;, &quot;Rectangular&quot;, &quot;Rectangular&quot;,</span>
<span class="sd">        ...                        &quot;Round&quot;, &quot;Rectangular&quot;, &quot;Round&quot;),</span>
<span class="sd">        ...    &quot;Amount&quot;, make_array(4, 6, 12, 7, 9, 2),</span>
<span class="sd">        ...    &quot;Price&quot;, make_array(1.30, 1.20, 2.00, 1.75, 0, 3.00))</span>

<span class="sd">        &gt;&gt;&gt; marbles</span>
<span class="sd">        Color | Shape       | Amount | Price</span>
<span class="sd">        Red   | Round       | 4      | 1.3</span>
<span class="sd">        Green | Rectangular | 6      | 1.2</span>
<span class="sd">        Blue  | Rectangular | 12     | 2</span>
<span class="sd">        Red   | Round       | 7      | 1.75</span>
<span class="sd">        Green | Rectangular | 9      | 0</span>
<span class="sd">        Green | Round       | 2      | 3</span>

<span class="sd">        Use a value to select matching rows</span>

<span class="sd">        &gt;&gt;&gt; marbles.where(&quot;Price&quot;, 1.3)</span>
<span class="sd">        Color | Shape | Amount | Price</span>
<span class="sd">        Red   | Round | 4      | 1.3</span>

<span class="sd">        In general, a higher order predicate function such as the functions in</span>
<span class="sd">        ``datascience.predicates.are`` can be used.</span>

<span class="sd">        &gt;&gt;&gt; from datascience.predicates import are</span>
<span class="sd">        &gt;&gt;&gt; # equivalent to previous example</span>
<span class="sd">        &gt;&gt;&gt; marbles.where(&quot;Price&quot;, are.equal_to(1.3))</span>
<span class="sd">        Color | Shape | Amount | Price</span>
<span class="sd">        Red   | Round | 4      | 1.3</span>

<span class="sd">        &gt;&gt;&gt; marbles.where(&quot;Price&quot;, are.above(1.5))</span>
<span class="sd">        Color | Shape       | Amount | Price</span>
<span class="sd">        Blue  | Rectangular | 12     | 2</span>
<span class="sd">        Red   | Round       | 7      | 1.75</span>
<span class="sd">        Green | Round       | 2      | 3</span>

<span class="sd">        Use the optional argument ``other`` to apply predicates to compare</span>
<span class="sd">        columns.</span>

<span class="sd">        &gt;&gt;&gt; marbles.where(&quot;Price&quot;, are.above, &quot;Amount&quot;)</span>
<span class="sd">        Color | Shape | Amount | Price</span>
<span class="sd">        Green | Round | 2      | 3</span>

<span class="sd">        &gt;&gt;&gt; marbles.where(&quot;Price&quot;, are.equal_to, &quot;Amount&quot;) # empty table</span>
<span class="sd">        Color | Shape | Amount | Price</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_column</span><span class="p">(</span><span class="n">column_or_label</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">callable</span><span class="p">(</span><span class="n">value_or_predicate</span><span class="p">),</span> <span class="s2">&quot;Predicate required for 3-arg where&quot;</span>
            <span class="n">predicate</span> <span class="o">=</span> <span class="n">value_or_predicate</span>
            <span class="n">other</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_column</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
            <span class="n">column</span> <span class="o">=</span> <span class="p">[</span><span class="n">predicate</span><span class="p">(</span><span class="n">y</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">other</span><span class="p">)]</span>
        <span class="k">elif</span> <span class="n">value_or_predicate</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">callable</span><span class="p">(</span><span class="n">value_or_predicate</span><span class="p">):</span>
                <span class="n">predicate</span> <span class="o">=</span> <span class="n">_predicates</span><span class="o">.</span><span class="n">are</span><span class="o">.</span><span class="n">equal_to</span><span class="p">(</span><span class="n">value_or_predicate</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">predicate</span> <span class="o">=</span> <span class="n">value_or_predicate</span>
            <span class="n">column</span> <span class="o">=</span> <span class="p">[</span><span class="n">predicate</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">column</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">column</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span></div>

<div class="viewcode-block" id="Table.sort"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.sort.html#datascience.tables.Table.sort">[docs]</a>    <span class="k">def</span> <span class="nf">sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_or_label</span><span class="p">,</span> <span class="n">descending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">distinct</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a Table of rows sorted according to the values in a column.</span>

<span class="sd">        Args:</span>
<span class="sd">            ``column_or_label``: the column whose values are used for sorting.</span>

<span class="sd">            ``descending``: if True, sorting will be in descending, rather than</span>
<span class="sd">                ascending order.</span>

<span class="sd">            ``distinct``: if True, repeated values in ``column_or_label`` will</span>
<span class="sd">                be omitted.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An instance of ``Table`` containing rows sorted based on the values</span>
<span class="sd">            in ``column_or_label``.</span>

<span class="sd">        &gt;&gt;&gt; marbles = Table().with_columns(</span>
<span class="sd">        ...    &quot;Color&quot;, make_array(&quot;Red&quot;, &quot;Green&quot;, &quot;Blue&quot;, &quot;Red&quot;, &quot;Green&quot;, &quot;Green&quot;),</span>
<span class="sd">        ...    &quot;Shape&quot;, make_array(&quot;Round&quot;, &quot;Rectangular&quot;, &quot;Rectangular&quot;, &quot;Round&quot;, &quot;Rectangular&quot;, &quot;Round&quot;),</span>
<span class="sd">        ...    &quot;Amount&quot;, make_array(4, 6, 12, 7, 9, 2),</span>
<span class="sd">        ...    &quot;Price&quot;, make_array(1.30, 1.30, 2.00, 1.75, 1.40, 1.00))</span>
<span class="sd">        &gt;&gt;&gt; marbles</span>
<span class="sd">        Color | Shape       | Amount | Price</span>
<span class="sd">        Red   | Round       | 4      | 1.3</span>
<span class="sd">        Green | Rectangular | 6      | 1.3</span>
<span class="sd">        Blue  | Rectangular | 12     | 2</span>
<span class="sd">        Red   | Round       | 7      | 1.75</span>
<span class="sd">        Green | Rectangular | 9      | 1.4</span>
<span class="sd">        Green | Round       | 2      | 1</span>
<span class="sd">        &gt;&gt;&gt; marbles.sort(&quot;Amount&quot;)</span>
<span class="sd">        Color | Shape       | Amount | Price</span>
<span class="sd">        Green | Round       | 2      | 1</span>
<span class="sd">        Red   | Round       | 4      | 1.3</span>
<span class="sd">        Green | Rectangular | 6      | 1.3</span>
<span class="sd">        Red   | Round       | 7      | 1.75</span>
<span class="sd">        Green | Rectangular | 9      | 1.4</span>
<span class="sd">        Blue  | Rectangular | 12     | 2</span>
<span class="sd">        &gt;&gt;&gt; marbles.sort(&quot;Amount&quot;, descending = True)</span>
<span class="sd">        Color | Shape       | Amount | Price</span>
<span class="sd">        Blue  | Rectangular | 12     | 2</span>
<span class="sd">        Green | Rectangular | 9      | 1.4</span>
<span class="sd">        Red   | Round       | 7      | 1.75</span>
<span class="sd">        Green | Rectangular | 6      | 1.3</span>
<span class="sd">        Red   | Round       | 4      | 1.3</span>
<span class="sd">        Green | Round       | 2      | 1</span>
<span class="sd">        &gt;&gt;&gt; marbles.sort(3) # the Price column</span>
<span class="sd">        Color | Shape       | Amount | Price</span>
<span class="sd">        Green | Round       | 2      | 1</span>
<span class="sd">        Red   | Round       | 4      | 1.3</span>
<span class="sd">        Green | Rectangular | 6      | 1.3</span>
<span class="sd">        Green | Rectangular | 9      | 1.4</span>
<span class="sd">        Red   | Round       | 7      | 1.75</span>
<span class="sd">        Blue  | Rectangular | 12     | 2</span>
<span class="sd">        &gt;&gt;&gt; marbles.sort(3, distinct = True)</span>
<span class="sd">        Color | Shape       | Amount | Price</span>
<span class="sd">        Green | Round       | 2      | 1</span>
<span class="sd">        Red   | Round       | 4      | 1.3</span>
<span class="sd">        Green | Rectangular | 9      | 1.4</span>
<span class="sd">        Red   | Round       | 7      | 1.75</span>
<span class="sd">        Blue  | Rectangular | 12     | 2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_column</span><span class="p">(</span><span class="n">column_or_label</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">distinct</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">row_numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">row_numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;mergesort&#39;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">row_numbers</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_rows</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span> <span class="n">row_numbers</span>
        <span class="k">if</span> <span class="n">descending</span><span class="p">:</span>
            <span class="n">row_numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">row_numbers</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">row_numbers</span><span class="p">)</span></div>

<div class="viewcode-block" id="Table.group"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.group.html#datascience.tables.Table.group">[docs]</a>    <span class="k">def</span> <span class="nf">group</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_or_label</span><span class="p">,</span> <span class="n">collect</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Group rows by unique values in a column; count or aggregate others.</span>

<span class="sd">        Args:</span>
<span class="sd">            ``column_or_label``: values to group (column label or index, or array)</span>

<span class="sd">            ``collect``: a function applied to values in other columns for each group</span>

<span class="sd">        Returns:</span>
<span class="sd">            A Table with each row corresponding to a unique value in ``column_or_label``,</span>
<span class="sd">            where the first column contains the unique values from ``column_or_label``, and the</span>
<span class="sd">            second contains counts for each of the unique values. If ``collect`` is</span>
<span class="sd">            provided, a Table is returned with all original columns, each containing values</span>
<span class="sd">            calculated by first grouping rows according to ``column_or_label``, then applying</span>
<span class="sd">            ``collect`` to each set of grouped values in the other columns.</span>

<span class="sd">        Note:</span>
<span class="sd">            The grouped column will appear first in the result table. If ``collect`` does not</span>
<span class="sd">            accept arguments with one of the column types, that column will be empty in the resulting</span>
<span class="sd">            table.</span>

<span class="sd">        &gt;&gt;&gt; marbles = Table().with_columns(</span>
<span class="sd">        ...    &quot;Color&quot;, make_array(&quot;Red&quot;, &quot;Green&quot;, &quot;Blue&quot;, &quot;Red&quot;, &quot;Green&quot;, &quot;Green&quot;),</span>
<span class="sd">        ...    &quot;Shape&quot;, make_array(&quot;Round&quot;, &quot;Rectangular&quot;, &quot;Rectangular&quot;, &quot;Round&quot;, &quot;Rectangular&quot;, &quot;Round&quot;),</span>
<span class="sd">        ...    &quot;Amount&quot;, make_array(4, 6, 12, 7, 9, 2),</span>
<span class="sd">        ...    &quot;Price&quot;, make_array(1.30, 1.30, 2.00, 1.75, 1.40, 1.00))</span>
<span class="sd">        &gt;&gt;&gt; marbles</span>
<span class="sd">        Color | Shape       | Amount | Price</span>
<span class="sd">        Red   | Round       | 4      | 1.3</span>
<span class="sd">        Green | Rectangular | 6      | 1.3</span>
<span class="sd">        Blue  | Rectangular | 12     | 2</span>
<span class="sd">        Red   | Round       | 7      | 1.75</span>
<span class="sd">        Green | Rectangular | 9      | 1.4</span>
<span class="sd">        Green | Round       | 2      | 1</span>
<span class="sd">        &gt;&gt;&gt; marbles.group(&quot;Color&quot;) # just gives counts</span>
<span class="sd">        Color | count</span>
<span class="sd">        Blue  | 1</span>
<span class="sd">        Green | 3</span>
<span class="sd">        Red   | 2</span>
<span class="sd">        &gt;&gt;&gt; marbles.group(&quot;Color&quot;, max) # takes the max of each grouping, in each column</span>
<span class="sd">        Color | Shape max   | Amount max | Price max</span>
<span class="sd">        Blue  | Rectangular | 12         | 2</span>
<span class="sd">        Green | Round       | 9          | 1.4</span>
<span class="sd">        Red   | Round       | 7          | 1.75</span>
<span class="sd">        &gt;&gt;&gt; marbles.group(&quot;Shape&quot;, sum) # sum doesn&#39;t make sense for strings</span>
<span class="sd">        Shape       | Color sum | Amount sum | Price sum</span>
<span class="sd">        Rectangular |           | 27         | 4.7</span>
<span class="sd">        Round       |           | 13         | 4.05</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Assume that a call to group with a list of labels is a call to groups</span>
        <span class="k">if</span> <span class="n">_is_non_string_iterable</span><span class="p">(</span><span class="n">column_or_label</span><span class="p">)</span> <span class="ow">and</span> \
                <span class="nb">len</span><span class="p">(</span><span class="n">column_or_label</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_rows</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">(</span><span class="n">column_or_label</span><span class="p">,</span> <span class="n">collect</span><span class="p">)</span>

        <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">shallow</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">collect</span> <span class="o">=</span> <span class="n">_zero_on_type_error</span><span class="p">(</span><span class="n">collect</span><span class="p">)</span>

        <span class="c1"># Remove column used for grouping</span>
        <span class="n">column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_column</span><span class="p">(</span><span class="n">column_or_label</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">column_or_label</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">column_or_label</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">):</span>
            <span class="n">column_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_as_label</span><span class="p">(</span><span class="n">column_or_label</span><span class="p">)</span>
            <span class="k">del</span> <span class="bp">self</span><span class="p">[</span><span class="n">column_label</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">column_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unused_label</span><span class="p">(</span><span class="s1">&#39;group&#39;</span><span class="p">)</span>

        <span class="c1"># Group by column</span>
        <span class="n">groups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_by</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">groups</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="c1"># Generate grouped columns</span>
        <span class="k">if</span> <span class="n">collect</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">column_label</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span> <span class="k">if</span> <span class="n">column_label</span> <span class="o">!=</span> <span class="s1">&#39;count&#39;</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unused_label</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">)]</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">keys</span><span class="p">,</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">columns</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">):</span>
                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_collected_label</span><span class="p">(</span><span class="n">collect</span><span class="p">,</span> <span class="n">label</span><span class="p">))</span>
                <span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="n">collect</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">row</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">[</span><span class="n">k</span><span class="p">]]))</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">]</span>
                <span class="n">columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="n">grouped</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)()</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">columns</span><span class="p">))</span>
        <span class="k">assert</span> <span class="n">column_label</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unused_label</span><span class="p">(</span><span class="n">column_label</span><span class="p">)</span>
        <span class="n">grouped</span><span class="p">[</span><span class="n">column_label</span><span class="p">]</span> <span class="o">=</span> <span class="n">keys</span>
        <span class="n">grouped</span><span class="o">.</span><span class="n">move_to_start</span><span class="p">(</span><span class="n">column_label</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">grouped</span></div>

<div class="viewcode-block" id="Table.groups"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.groups.html#datascience.tables.Table.groups">[docs]</a>    <span class="k">def</span> <span class="nf">groups</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">collect</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Group rows by multiple columns, count or aggregate others.</span>

<span class="sd">        Args:</span>
<span class="sd">            ``labels``: list of column names (or indices) to group on</span>

<span class="sd">            ``collect``: a function applied to values in other columns for each group</span>

<span class="sd">        Returns: A Table with each row corresponding to a unique combination of values in</span>
<span class="sd">            the columns specified in ``labels``, where the first columns are those</span>
<span class="sd">            specified in ``labels``, followed by a column of counts for each of the unique</span>
<span class="sd">            values. If ``collect`` is provided, a Table is returned with all original</span>
<span class="sd">            columns, each containing values calculated by first grouping rows according to</span>
<span class="sd">            to values in the ``labels`` column, then applying ``collect`` to each set of</span>
<span class="sd">            grouped values in the other columns.</span>

<span class="sd">        Note:</span>
<span class="sd">            The grouped columns will appear first in the result table. If ``collect`` does not</span>
<span class="sd">            accept arguments with one of the column types, that column will be empty in the resulting</span>
<span class="sd">            table.</span>

<span class="sd">        &gt;&gt;&gt; marbles = Table().with_columns(</span>
<span class="sd">        ...    &quot;Color&quot;, make_array(&quot;Red&quot;, &quot;Green&quot;, &quot;Blue&quot;, &quot;Red&quot;, &quot;Green&quot;, &quot;Green&quot;),</span>
<span class="sd">        ...    &quot;Shape&quot;, make_array(&quot;Round&quot;, &quot;Rectangular&quot;, &quot;Rectangular&quot;, &quot;Round&quot;, &quot;Rectangular&quot;, &quot;Round&quot;),</span>
<span class="sd">        ...    &quot;Amount&quot;, make_array(4, 6, 12, 7, 9, 2),</span>
<span class="sd">        ...    &quot;Price&quot;, make_array(1.30, 1.30, 2.00, 1.75, 1.40, 1.00))</span>
<span class="sd">        &gt;&gt;&gt; marbles</span>
<span class="sd">        Color | Shape       | Amount | Price</span>
<span class="sd">        Red   | Round       | 4      | 1.3</span>
<span class="sd">        Green | Rectangular | 6      | 1.3</span>
<span class="sd">        Blue  | Rectangular | 12     | 2</span>
<span class="sd">        Red   | Round       | 7      | 1.75</span>
<span class="sd">        Green | Rectangular | 9      | 1.4</span>
<span class="sd">        Green | Round       | 2      | 1</span>
<span class="sd">        &gt;&gt;&gt; marbles.groups([&quot;Color&quot;, &quot;Shape&quot;])</span>
<span class="sd">        Color | Shape       | count</span>
<span class="sd">        Blue  | Rectangular | 1</span>
<span class="sd">        Green | Rectangular | 2</span>
<span class="sd">        Green | Round       | 1</span>
<span class="sd">        Red   | Round       | 2</span>
<span class="sd">        &gt;&gt;&gt; marbles.groups([&quot;Color&quot;, &quot;Shape&quot;], sum)</span>
<span class="sd">        Color | Shape       | Amount sum | Price sum</span>
<span class="sd">        Blue  | Rectangular | 12         | 2</span>
<span class="sd">        Green | Rectangular | 15         | 2.7</span>
<span class="sd">        Green | Round       | 2          | 1</span>
<span class="sd">        Red   | Round       | 11         | 3.05</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Assume that a call to groups with one label is a call to group</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_is_non_string_iterable</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">collect</span><span class="o">=</span><span class="n">collect</span><span class="p">)</span>

        <span class="n">collect</span> <span class="o">=</span> <span class="n">_zero_on_type_error</span><span class="p">(</span><span class="n">collect</span><span class="p">)</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_as_labels</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All labels must exist in the table&quot;</span><span class="p">)</span>
            <span class="n">columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_column</span><span class="p">(</span><span class="n">label</span><span class="p">))</span>
        <span class="n">grouped</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">columns</span><span class="p">)),</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="p">)</span>
        <span class="n">grouped</span><span class="o">.</span><span class="n">_columns</span><span class="o">.</span><span class="n">popitem</span><span class="p">(</span><span class="n">last</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Discard the column of tuples</span>

        <span class="c1"># Flatten grouping values and move them to front</span>
        <span class="n">counts</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">grouped</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">grouped</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">_assert_same</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
            <span class="n">grouped</span><span class="o">.</span><span class="n">move_to_start</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

        <span class="c1"># Aggregate other values</span>
        <span class="k">if</span> <span class="n">collect</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">count</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span> <span class="k">if</span> <span class="s1">&#39;count&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">labels</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unused_label</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">grouped</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span><span class="o">.</span><span class="n">with_column</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">counts</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">grouped</span><span class="o">.</span><span class="n">labels</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">column</span> <span class="o">=</span> <span class="p">[</span><span class="n">collect</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">grouped</span><span class="p">[</span><span class="n">label</span><span class="p">]]</span>
                <span class="k">del</span> <span class="n">grouped</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
                <span class="n">grouped</span><span class="p">[</span><span class="n">_collected_label</span><span class="p">(</span><span class="n">collect</span><span class="p">,</span> <span class="n">label</span><span class="p">)]</span> <span class="o">=</span> <span class="n">column</span>
            <span class="k">return</span> <span class="n">grouped</span></div>

<div class="viewcode-block" id="Table.pivot"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.pivot.html#datascience.tables.Table.pivot">[docs]</a>    <span class="k">def</span> <span class="nf">pivot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">collect</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">zero</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate a table with a column for each unique value in ``columns``,</span>
<span class="sd">        with rows for each unique value in ``rows``. Each row counts/aggregates</span>
<span class="sd">        the values that match both row and column based on ``collect``.</span>

<span class="sd">        Args:</span>
<span class="sd">            ``columns`` -- a single column label or index, (``str`` or ``int``),</span>
<span class="sd">                used to create new columns, based on its unique values.</span>
<span class="sd">            ``rows`` -- row labels or indices, (``str`` or ``int`` or list),</span>
<span class="sd">                used to create new rows based on it&#39;s unique values.</span>
<span class="sd">            ``values`` -- column label in table for use in aggregation.</span>
<span class="sd">                Default None.</span>
<span class="sd">            ``collect`` -- aggregation function, used to group ``values``</span>
<span class="sd">                over row-column combinations. Default None.</span>
<span class="sd">            ``zero`` -- zero value to use for non-existent row-column</span>
<span class="sd">                combinations.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError -- if ``collect`` is passed in and ``values`` is not,</span>
<span class="sd">                vice versa.</span>

<span class="sd">        Returns:</span>
<span class="sd">            New pivot table, with row-column combinations, as specified, with</span>
<span class="sd">            aggregated ``values`` by ``collect`` across the intersection of</span>
<span class="sd">            ``columns`` and ``rows``. Simple counts provided if values and</span>
<span class="sd">            collect are None, as default.</span>

<span class="sd">        &gt;&gt;&gt; titanic = Table().with_columns(&#39;age&#39;, make_array(21, 44, 56, 89, 95</span>
<span class="sd">        ...    , 40, 80, 45), &#39;survival&#39;, make_array(0,0,0,1, 1, 1, 0, 1),</span>
<span class="sd">        ...    &#39;gender&#39;,  make_array(&#39;M&#39;, &#39;M&#39;, &#39;M&#39;, &#39;M&#39;, &#39;F&#39;, &#39;F&#39;, &#39;F&#39;, &#39;F&#39;),</span>
<span class="sd">        ...    &#39;prediction&#39;, make_array(0, 0, 1, 1, 0, 1, 0, 1))</span>
<span class="sd">        &gt;&gt;&gt; titanic</span>
<span class="sd">        age  | survival | gender | prediction</span>
<span class="sd">        21   | 0        | M      | 0</span>
<span class="sd">        44   | 0        | M      | 0</span>
<span class="sd">        56   | 0        | M      | 1</span>
<span class="sd">        89   | 1        | M      | 1</span>
<span class="sd">        95   | 1        | F      | 0</span>
<span class="sd">        40   | 1        | F      | 1</span>
<span class="sd">        80   | 0        | F      | 0</span>
<span class="sd">        45   | 1        | F      | 1</span>
<span class="sd">        &gt;&gt;&gt; titanic.pivot(&#39;survival&#39;, &#39;gender&#39;)</span>
<span class="sd">        gender | 0    | 1</span>
<span class="sd">        F      | 1    | 3</span>
<span class="sd">        M      | 3    | 1</span>
<span class="sd">        &gt;&gt;&gt; titanic.pivot(&#39;prediction&#39;, &#39;gender&#39;)</span>
<span class="sd">        gender | 0    | 1</span>
<span class="sd">        F      | 2    | 2</span>
<span class="sd">        M      | 2    | 2</span>
<span class="sd">        &gt;&gt;&gt; titanic.pivot(&#39;survival&#39;, &#39;gender&#39;, values=&#39;age&#39;, collect = np.mean)</span>
<span class="sd">        gender | 0       | 1</span>
<span class="sd">        F      | 80      | 60</span>
<span class="sd">        M      | 40.3333 | 89</span>
<span class="sd">        &gt;&gt;&gt; titanic.pivot(&#39;survival&#39;, make_array(&#39;prediction&#39;, &#39;gender&#39;))</span>
<span class="sd">        prediction | gender | 0    | 1</span>
<span class="sd">        0          | F      | 1    | 1</span>
<span class="sd">        0          | M      | 2    | 0</span>
<span class="sd">        1          | F      | 0    | 2</span>
<span class="sd">        1          | M      | 1    | 1</span>
<span class="sd">        &gt;&gt;&gt; titanic.pivot(&#39;survival&#39;, &#39;gender&#39;, values = &#39;age&#39;)</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">           ...</span>
<span class="sd">        TypeError: values requires collect to be specified</span>
<span class="sd">        &gt;&gt;&gt; titanic.pivot(&#39;survival&#39;, &#39;gender&#39;, collect = np.mean)</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">           ...</span>
<span class="sd">        TypeError: collect requires values to be specified</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">collect</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">values</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;collect requires values to be specified&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">collect</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;values requires collect to be specified&#39;</span><span class="p">)</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_as_label</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_as_labels</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">values</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">selected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="n">columns</span><span class="p">]</span> <span class="o">+</span> <span class="n">rows</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">selected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="n">columns</span><span class="p">,</span> <span class="n">values</span><span class="p">]</span> <span class="o">+</span> <span class="n">rows</span><span class="p">)</span>
        <span class="n">grouped</span> <span class="o">=</span> <span class="n">selected</span><span class="o">.</span><span class="n">groups</span><span class="p">([</span><span class="n">columns</span><span class="p">]</span> <span class="o">+</span> <span class="n">rows</span><span class="p">,</span> <span class="n">collect</span><span class="p">)</span>

        <span class="c1"># Generate existing combinations of values from columns in rows</span>
        <span class="n">rows_values</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span><span class="o">.</span><span class="n">rows</span><span class="p">)))</span>
        <span class="n">pivoted</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">rows</span><span class="p">)</span><span class="o">.</span><span class="n">with_rows</span><span class="p">(</span><span class="n">rows_values</span><span class="p">)</span>

        <span class="c1"># Generate other columns and add them to pivoted</span>
        <span class="n">by_columns</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">index_by</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">by_columns</span><span class="p">):</span>
            <span class="n">tuples</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">by_columns</span><span class="p">[</span><span class="n">label</span><span class="p">]]</span> <span class="c1"># Discard column value</span>
            <span class="n">column</span> <span class="o">=</span> <span class="n">_fill_with_zeros</span><span class="p">(</span><span class="n">rows_values</span><span class="p">,</span> <span class="n">tuples</span><span class="p">,</span> <span class="n">zero</span><span class="p">)</span>
            <span class="n">pivot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unused_label</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">label</span><span class="p">))</span>
            <span class="n">pivoted</span><span class="p">[</span><span class="n">pivot</span><span class="p">]</span> <span class="o">=</span> <span class="n">column</span>
        <span class="k">return</span> <span class="n">pivoted</span></div>

<div class="viewcode-block" id="Table.pivot_bin"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.pivot_bin.html#datascience.tables.Table.pivot_bin">[docs]</a>    <span class="k">def</span> <span class="nf">pivot_bin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pivot_columns</span><span class="p">,</span> <span class="n">value_column</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">vargs</span><span class="p">)</span> <span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Form a table with columns formed by the unique tuples in pivot_columns</span>
<span class="sd">        containing counts per bin of the values associated with each tuple in the value_column.</span>

<span class="sd">        By default, bins are chosen to contain all values in the value_column. The</span>
<span class="sd">        following named arguments from numpy.histogram can be applied to</span>
<span class="sd">        specialize bin widths:</span>

<span class="sd">        Args:</span>
<span class="sd">            ``bins`` (int or sequence of scalars): If bins is an int,</span>
<span class="sd">                it defines the number of equal-width bins in the given range</span>
<span class="sd">                (10, by default). If bins is a sequence, it defines the bin</span>
<span class="sd">                edges, including the rightmost edge, allowing for non-uniform</span>
<span class="sd">                bin widths.</span>

<span class="sd">            ``range`` ((float, float)): The lower and upper range of</span>
<span class="sd">                the bins. If not provided, range contains all values in the</span>
<span class="sd">                table. Values outside the range are ignored.</span>

<span class="sd">            ``normed`` (bool): If False, the result will contain the number of</span>
<span class="sd">                samples in each bin. If True, the result is normalized such that</span>
<span class="sd">                the integral over the range is 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pivot_columns</span> <span class="o">=</span> <span class="n">_as_labels</span><span class="p">(</span><span class="n">pivot_columns</span><span class="p">)</span>
        <span class="n">selected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pivot_columns</span> <span class="o">+</span> <span class="p">[</span><span class="n">value_column</span><span class="p">])</span>
        <span class="n">grouped</span> <span class="o">=</span> <span class="n">selected</span><span class="o">.</span><span class="n">groups</span><span class="p">(</span><span class="n">pivot_columns</span><span class="p">,</span> <span class="n">collect</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">)</span>

        <span class="c1"># refine bins by taking a histogram over all the data</span>
        <span class="k">if</span> <span class="n">bins</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">vargs</span><span class="p">[</span><span class="s1">&#39;bins&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bins</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">rbins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">value_column</span><span class="p">],</span><span class="o">**</span><span class="n">vargs</span><span class="p">)</span>
        <span class="c1"># create a table with these bins a first column and counts for each group</span>
        <span class="n">vargs</span><span class="p">[</span><span class="s1">&#39;bins&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rbins</span>
        <span class="n">binned</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)()</span><span class="o">.</span><span class="n">with_column</span><span class="p">(</span><span class="s1">&#39;bin&#39;</span><span class="p">,</span><span class="n">rbins</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
            <span class="n">col_label</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="n">group</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
            <span class="n">col_vals</span> <span class="o">=</span> <span class="n">group</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">counts</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">col_vals</span><span class="p">,</span><span class="o">**</span><span class="n">vargs</span><span class="p">)</span>
            <span class="n">binned</span><span class="p">[</span><span class="n">col_label</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">binned</span></div>

<div class="viewcode-block" id="Table.stack"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.stack.html#datascience.tables.Table.stack">[docs]</a>    <span class="k">def</span> <span class="nf">stack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Takes k original columns and returns two columns, with col. 1 of</span>
<span class="sd">        all column names and col. 2 of all associated data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rows</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">labels</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
            <span class="p">[</span><span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">getattr</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">key</span><span class="p">),</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">row</span><span class="o">.</span><span class="n">asdict</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
             <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="n">key</span> <span class="ow">and</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)([</span><span class="n">key</span><span class="p">,</span> <span class="s1">&#39;column&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">with_rows</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span></div>

<div class="viewcode-block" id="Table.join"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.join.html#datascience.tables.Table.join">[docs]</a>    <span class="k">def</span> <span class="nf">join</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_label</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">other_label</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a new table with the columns of self and other, containing</span>
<span class="sd">        rows for all values of a column that appear in both tables.</span>

<span class="sd">        Args:</span>
<span class="sd">            ``column_label``:  label of column or array of labels in self that is used to</span>
<span class="sd">                join  rows of ``other``.</span>
<span class="sd">            ``other``: Table object to join with self on matching values of</span>
<span class="sd">                ``column_label``.</span>

<span class="sd">        Kwargs:</span>
<span class="sd">            ``other_label``: default None, assumes ``column_label``.</span>
<span class="sd">                Otherwise in ``other`` used to join rows.</span>

<span class="sd">        Returns:</span>
<span class="sd">            New table self joined with ``other`` by matching values in</span>
<span class="sd">            ``column_label`` and ``other_label``. If the resulting join is</span>
<span class="sd">            empty, returns None.</span>

<span class="sd">        &gt;&gt;&gt; table = Table().with_columns(&#39;a&#39;, make_array(9, 3, 3, 1),</span>
<span class="sd">        ...     &#39;b&#39;, make_array(1, 2, 2, 10),</span>
<span class="sd">        ...     &#39;c&#39;, make_array(3, 4, 5, 6))</span>
<span class="sd">        &gt;&gt;&gt; table</span>
<span class="sd">        a    | b    | c</span>
<span class="sd">        9    | 1    | 3</span>
<span class="sd">        3    | 2    | 4</span>
<span class="sd">        3    | 2    | 5</span>
<span class="sd">        1    | 10   | 6</span>
<span class="sd">        &gt;&gt;&gt; table2 = Table().with_columns( &#39;a&#39;, make_array(9, 1, 1, 1),</span>
<span class="sd">        ... &#39;d&#39;, make_array(1, 2, 2, 10),</span>
<span class="sd">        ... &#39;e&#39;, make_array(3, 4, 5, 6))</span>
<span class="sd">        &gt;&gt;&gt; table2</span>
<span class="sd">        a    | d    | e</span>
<span class="sd">        9    | 1    | 3</span>
<span class="sd">        1    | 2    | 4</span>
<span class="sd">        1    | 2    | 5</span>
<span class="sd">        1    | 10   | 6</span>
<span class="sd">        &gt;&gt;&gt; table.join(&#39;a&#39;, table2)</span>
<span class="sd">        a    | b    | c    | d    | e</span>
<span class="sd">        1    | 10   | 6    | 2    | 4</span>
<span class="sd">        1    | 10   | 6    | 2    | 5</span>
<span class="sd">        1    | 10   | 6    | 10   | 6</span>
<span class="sd">        9    | 1    | 3    | 1    | 3</span>
<span class="sd">        &gt;&gt;&gt; table.join(&#39;a&#39;, table2, &#39;a&#39;) # Equivalent to previous join</span>
<span class="sd">        a    | b    | c    | d    | e</span>
<span class="sd">        1    | 10   | 6    | 2    | 4</span>
<span class="sd">        1    | 10   | 6    | 2    | 5</span>
<span class="sd">        1    | 10   | 6    | 10   | 6</span>
<span class="sd">        9    | 1    | 3    | 1    | 3</span>
<span class="sd">        &gt;&gt;&gt; table.join(&#39;a&#39;, table2, &#39;d&#39;) # Repeat column labels relabeled</span>
<span class="sd">        a    | b    | c    | a_2  | e</span>
<span class="sd">        1    | 10   | 6    | 9    | 3</span>
<span class="sd">        &gt;&gt;&gt; table2 #table2 has three rows with a = 1</span>
<span class="sd">        a    | d    | e</span>
<span class="sd">        9    | 1    | 3</span>
<span class="sd">        1    | 2    | 4</span>
<span class="sd">        1    | 2    | 5</span>
<span class="sd">        1    | 10   | 6</span>
<span class="sd">        &gt;&gt;&gt; table #table has only one row with a = 1</span>
<span class="sd">        a    | b    | c</span>
<span class="sd">        9    | 1    | 3</span>
<span class="sd">        3    | 2    | 4</span>
<span class="sd">        3    | 2    | 5</span>
<span class="sd">        1    | 10   | 6</span>
<span class="sd">        &gt;&gt;&gt; table.join([&#39;a&#39;, &#39;b&#39;], table2, [&#39;a&#39;, &#39;d&#39;]) # joining on multiple columns</span>
<span class="sd">        a    | b    | c    | e</span>
<span class="sd">        1    | 10   | 6    | 6</span>
<span class="sd">        9    | 1    | 3    | 3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_rows</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">other</span><span class="o">.</span><span class="n">num_rows</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">other_label</span><span class="p">:</span>
            <span class="n">other_label</span> <span class="o">=</span> <span class="n">column_label</span>

        <span class="c1"># checking to see if joining on multiple columns</span>
        <span class="k">if</span> <span class="n">_is_non_string_iterable</span><span class="p">(</span><span class="n">column_label</span><span class="p">):</span>
            <span class="c1"># then we are going to be joining multiple labels</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_multiple_join</span><span class="p">(</span><span class="n">column_label</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">other_label</span><span class="p">)</span>

        <span class="c1"># original single column join</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_join</span><span class="p">(</span><span class="n">column_label</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">other_label</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_join</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_label</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">other_label</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot;joins when COLUMN_LABEL is a string&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_rows</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">other</span><span class="o">.</span><span class="n">num_rows</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">other_label</span><span class="p">:</span>
            <span class="n">other_label</span> <span class="o">=</span> <span class="n">column_label</span>

        <span class="n">self_rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_by</span><span class="p">(</span><span class="n">column_label</span><span class="p">)</span>
        <span class="n">other_rows</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">index_by</span><span class="p">(</span><span class="n">other_label</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_join_helper</span><span class="p">([</span><span class="n">column_label</span><span class="p">],</span> <span class="n">self_rows</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="p">[</span><span class="n">other_label</span><span class="p">],</span> <span class="n">other_rows</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_multiple_join</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_label</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">other_label</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot;joins when column_label is a non-string iterable&quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">column_label</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">other_label</span><span class="p">),</span> <span class="s1">&#39;unequal number of columns&#39;</span>

        <span class="n">self_rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_multi_index</span><span class="p">(</span><span class="n">column_label</span><span class="p">)</span>
        <span class="n">other_rows</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_multi_index</span><span class="p">(</span><span class="n">other_label</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_join_helper</span><span class="p">(</span><span class="n">column_label</span><span class="p">,</span> <span class="n">self_rows</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">other_label</span><span class="p">,</span> <span class="n">other_rows</span><span class="p">)</span>
        

    <span class="k">def</span> <span class="nf">_join_helper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_label</span><span class="p">,</span> <span class="n">self_rows</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">other_label</span><span class="p">,</span> <span class="n">other_rows</span><span class="p">):</span>
        <span class="c1"># Gather joined rows from self_rows that have join values in other_rows</span>
        <span class="n">joined_rows</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">v</span><span class="p">,</span> <span class="n">rows</span> <span class="ow">in</span> <span class="n">self_rows</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">other_rows</span><span class="p">:</span>
                <span class="n">joined_rows</span> <span class="o">+=</span> <span class="p">[</span><span class="n">row</span> <span class="o">+</span> <span class="n">o</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">other_rows</span><span class="p">[</span><span class="n">v</span><span class="p">]]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">joined_rows</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Build joined table</span>
        <span class="n">self_labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">)</span>
        <span class="n">other_labels</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_unused_label</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">labels</span><span class="p">]</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">self_labels</span> <span class="o">+</span> <span class="n">other_labels</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">self_labels</span> <span class="o">+</span> <span class="n">other_labels</span><span class="p">))):</span>
            <span class="n">other_labels</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_unused_label_in_either_table</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">labels</span><span class="p">]</span>
        <span class="n">other_labels_map</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="n">other_labels</span><span class="p">))</span>
        <span class="n">joined</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">self_labels</span> <span class="o">+</span> <span class="n">other_labels</span><span class="p">)</span><span class="o">.</span><span class="n">with_rows</span><span class="p">(</span><span class="n">joined_rows</span><span class="p">)</span>

        <span class="c1"># Copy formats from both tables</span>
        <span class="n">joined</span><span class="o">.</span><span class="n">_formats</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_formats</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">_formats</span><span class="p">:</span>
            <span class="n">joined</span><span class="o">.</span><span class="n">_formats</span><span class="p">[</span><span class="n">other_labels_map</span><span class="p">[</span><span class="n">label</span><span class="p">]]</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_formats</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>

        <span class="c1"># Remove redundant column, but perhaps save its formatting</span>
        <span class="k">for</span> <span class="n">duplicate</span> <span class="ow">in</span> <span class="n">other_label</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">joined</span><span class="p">[</span><span class="n">other_labels_map</span><span class="p">[</span><span class="n">duplicate</span><span class="p">]]</span>
        <span class="k">for</span> <span class="n">duplicate</span> <span class="ow">in</span> <span class="n">other_label</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">duplicate</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_formats</span> <span class="ow">and</span> <span class="n">duplicate</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">_formats</span><span class="p">:</span>
                <span class="n">joined</span><span class="o">.</span><span class="n">_formats</span><span class="p">[</span><span class="n">duplicate</span><span class="p">]</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_formats</span><span class="p">[</span><span class="n">duplicate</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">column_label</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">joined</span> <span class="o">=</span> <span class="n">joined</span><span class="o">.</span><span class="n">move_to_start</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">joined</span>

<div class="viewcode-block" id="Table.stats"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.stats.html#datascience.tables.Table.stats">[docs]</a>    <span class="k">def</span> <span class="nf">stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ops</span><span class="o">=</span><span class="p">(</span><span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">,</span> <span class="nb">sum</span><span class="p">)):</span>
        <span class="sd">&quot;&quot;&quot;Compute statistics for each column and place them in a table.&quot;&quot;&quot;</span>
        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">op</span><span class="o">.</span><span class="vm">__name__</span> <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">ops</span><span class="p">]</span>
        <span class="n">ops</span> <span class="o">=</span> <span class="p">[</span><span class="n">_zero_on_type_error</span><span class="p">(</span><span class="n">op</span><span class="p">)</span> <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">ops</span><span class="p">]</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="p">[[</span><span class="n">op</span><span class="p">(</span><span class="n">column</span><span class="p">)</span> <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">ops</span><span class="p">]</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
        <span class="n">table</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)()</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="n">columns</span><span class="p">))</span>
        <span class="n">stats</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">_unused_label</span><span class="p">(</span><span class="s1">&#39;statistic&#39;</span><span class="p">)</span>
        <span class="n">table</span><span class="p">[</span><span class="n">stats</span><span class="p">]</span> <span class="o">=</span> <span class="n">names</span>
        <span class="n">table</span><span class="o">.</span><span class="n">move_to_start</span><span class="p">(</span><span class="n">stats</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">table</span></div>

    <span class="k">def</span> <span class="nf">_as_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index_or_label</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert index to label.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index_or_label</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">index_or_label</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index_or_label</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">index_or_label</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">index_or_label</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; is not a label or index&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_as_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label_or_labels</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert single label to list and convert indices to labels.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_as_label</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">_as_labels</span><span class="p">(</span><span class="n">label_or_labels</span><span class="p">)]</span>

    <span class="k">def</span> <span class="nf">_varargs_as_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Converts a list of labels or singleton list of list of labels into</span>
<span class="sd">        a list of labels.  Useful when labels are passed as varargs.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_as_labels</span><span class="p">(</span><span class="n">_varargs_labels_as_list</span><span class="p">(</span><span class="n">label_list</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_unused_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate an unused label.&quot;&quot;&quot;</span>
        <span class="n">original</span> <span class="o">=</span> <span class="n">label</span>
        <span class="n">existing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">while</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">existing</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">original</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">label</span>

    <span class="k">def</span> <span class="nf">_unused_label_in_either_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">original</span> <span class="o">=</span> <span class="n">label</span>
        <span class="n">existing_self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span>
        <span class="n">existing_other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">labels</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">while</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">existing_self</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">original</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">while</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">existing_other</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">original</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">label</span>

    <span class="k">def</span> <span class="nf">_get_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_or_label</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert label to column and check column length.&quot;&quot;&quot;</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">column_or_label</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Hashable</span><span class="p">)</span> <span class="ow">and</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;label &quot;</span><span class="si">{}</span><span class="s1">&quot; not in labels </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_rows</span><span class="p">,</span> <span class="s1">&#39;column length mismatch&#39;</span>
            <span class="k">return</span> <span class="n">c</span>

<div class="viewcode-block" id="Table.percentile"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.percentile.html#datascience.tables.Table.percentile">[docs]</a>    <span class="k">def</span> <span class="nf">percentile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a new table with one row containing the pth percentile for</span>
<span class="sd">        each column.</span>

<span class="sd">        Assumes that each column only contains one type of value.</span>

<span class="sd">        Returns a new table with one row and the same column labels.</span>
<span class="sd">        The row contains the pth percentile of the original column, where the</span>
<span class="sd">        pth percentile of a column is the smallest value that at at least as</span>
<span class="sd">        large as the p% of numbers in the column.</span>

<span class="sd">        &gt;&gt;&gt; table = Table().with_columns(</span>
<span class="sd">        ...     &#39;count&#39;,  make_array(9, 3, 3, 1),</span>
<span class="sd">        ...     &#39;points&#39;, make_array(1, 2, 2, 10))</span>
<span class="sd">        &gt;&gt;&gt; table</span>
<span class="sd">        count | points</span>
<span class="sd">        9     | 1</span>
<span class="sd">        3     | 2</span>
<span class="sd">        3     | 2</span>
<span class="sd">        1     | 10</span>
<span class="sd">        &gt;&gt;&gt; table.percentile(80)</span>
<span class="sd">        count | points</span>
<span class="sd">        9     | 10</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">percentiles</span> <span class="o">=</span> <span class="p">[[</span><span class="n">_util</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">column</span><span class="p">)]</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_with_columns</span><span class="p">(</span><span class="n">percentiles</span><span class="p">)</span></div>

<div class="viewcode-block" id="Table.sample"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.sample.html#datascience.tables.Table.sample">[docs]</a>    <span class="k">def</span> <span class="nf">sample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">with_replacement</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a new table where k rows are randomly sampled from the</span>
<span class="sd">        original table.</span>

<span class="sd">        Args:</span>
<span class="sd">            ``k`` -- specifies the number of rows (``int``) to be sampled from</span>
<span class="sd">               the table. Default is k equal to number of rows in the table.</span>

<span class="sd">            ``with_replacement`` -- (``bool``) By default True;</span>
<span class="sd">                Samples ``k`` rows with replacement from table, else samples</span>
<span class="sd">                ``k`` rows without replacement.</span>

<span class="sd">            ``weights`` -- Array specifying probability the ith row of the</span>
<span class="sd">                table is sampled. Defaults to None, which samples each row</span>
<span class="sd">                with equal probability. ``weights`` must be a valid probability</span>
<span class="sd">                distribution -- i.e. an array the length of the number of rows,</span>
<span class="sd">                summing to 1.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError -- if ``weights`` is not length equal to number of rows</span>
<span class="sd">                in the table; or, if ``weights`` does not sum to 1.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A new instance of ``Table`` with ``k`` rows resampled.</span>

<span class="sd">        &gt;&gt;&gt; jobs = Table().with_columns(</span>
<span class="sd">        ...     &#39;job&#39;,  make_array(&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;),</span>
<span class="sd">        ...     &#39;wage&#39;, make_array(10, 20, 15, 8))</span>
<span class="sd">        &gt;&gt;&gt; jobs</span>
<span class="sd">        job  | wage</span>
<span class="sd">        a    | 10</span>
<span class="sd">        b    | 20</span>
<span class="sd">        c    | 15</span>
<span class="sd">        d    | 8</span>
<span class="sd">        &gt;&gt;&gt; jobs.sample() # doctest: +SKIP</span>
<span class="sd">        job  | wage</span>
<span class="sd">        b    | 20</span>
<span class="sd">        b    | 20</span>
<span class="sd">        a    | 10</span>
<span class="sd">        d    | 8</span>
<span class="sd">        &gt;&gt;&gt; jobs.sample(with_replacement=True) # doctest: +SKIP</span>
<span class="sd">        job  | wage</span>
<span class="sd">        d    | 8</span>
<span class="sd">        b    | 20</span>
<span class="sd">        c    | 15</span>
<span class="sd">        a    | 10</span>
<span class="sd">        &gt;&gt;&gt; jobs.sample(k = 2) # doctest: +SKIP</span>
<span class="sd">        job  | wage</span>
<span class="sd">        b    | 20</span>
<span class="sd">        c    | 15</span>
<span class="sd">        &gt;&gt;&gt; ws =  make_array(0.5, 0.5, 0, 0)</span>
<span class="sd">        &gt;&gt;&gt; jobs.sample(k=2, with_replacement=True, weights=ws) # doctest: +SKIP</span>
<span class="sd">        job  | wage</span>
<span class="sd">        a    | 10</span>
<span class="sd">        a    | 10</span>
<span class="sd">        &gt;&gt;&gt; jobs.sample(k=2, weights=make_array(1, 0, 1, 0))</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        ValueError: probabilities do not sum to 1</span>
<span class="sd">        &gt;&gt;&gt; jobs.sample(k=2, weights=make_array(1, 0, 0)) # Weights must be length of table.</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        ValueError: &#39;a&#39; and &#39;p&#39; must have same size</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_rows</span>
        <span class="k">if</span> <span class="n">k</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">n</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="n">with_replacement</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="p">[[</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
        <span class="n">sample</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_with_columns</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sample</span></div>

<div class="viewcode-block" id="Table.shuffle"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.shuffle.html#datascience.tables.Table.shuffle">[docs]</a>    <span class="k">def</span> <span class="nf">shuffle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a new table where all the rows are randomly shuffled from the</span>
<span class="sd">        original table..</span>

<span class="sd">        Returns:</span>
<span class="sd">            A new instance of ``Table`` with all ``k`` rows shuffled.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">with_replacement</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="Table.sample_from_distribution"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.sample_from_distribution.html#datascience.tables.Table.sample_from_distribution">[docs]</a>    <span class="k">def</span> <span class="nf">sample_from_distribution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distribution</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">proportions</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a new table with the same number of rows and a new column.</span>
<span class="sd">        The values in the distribution column are define a multinomial.</span>
<span class="sd">        They are replaced by sample counts/proportions in the output.</span>

<span class="sd">        &gt;&gt;&gt; sizes = Table([&#39;size&#39;, &#39;count&#39;]).with_rows([</span>
<span class="sd">        ...     [&#39;small&#39;, 50],</span>
<span class="sd">        ...     [&#39;medium&#39;, 100],</span>
<span class="sd">        ...     [&#39;big&#39;, 50],</span>
<span class="sd">        ... ])</span>
<span class="sd">        &gt;&gt;&gt; sizes.sample_from_distribution(&#39;count&#39;, 1000) # doctest: +SKIP</span>
<span class="sd">        size   | count | count sample</span>
<span class="sd">        small  | 50    | 239</span>
<span class="sd">        medium | 100   | 496</span>
<span class="sd">        big    | 50    | 265</span>
<span class="sd">        &gt;&gt;&gt; sizes.sample_from_distribution(&#39;count&#39;, 1000, True) # doctest: +SKIP</span>
<span class="sd">        size   | count | count sample</span>
<span class="sd">        small  | 50    | 0.24</span>
<span class="sd">        medium | 100   | 0.51</span>
<span class="sd">        big    | 50    | 0.25</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_column</span><span class="p">(</span><span class="n">distribution</span><span class="p">)</span>
        <span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">total</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">dist</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;Counts or a distribution required&#39;</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">dist</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>
        <span class="n">sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multinomial</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">proportions</span><span class="p">:</span>
            <span class="n">sample</span> <span class="o">=</span> <span class="n">sample</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unused_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_as_label</span><span class="p">(</span><span class="n">distribution</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; sample&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_column</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">sample</span><span class="p">)</span></div>

<div class="viewcode-block" id="Table.split"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.split.html#datascience.tables.Table.split">[docs]</a>    <span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a tuple of two tables where the first table contains</span>
<span class="sd">        ``k`` rows randomly sampled and the second contains the remaining rows.</span>

<span class="sd">        Args:</span>
<span class="sd">            ``k`` (int): The number of rows randomly sampled into the first</span>
<span class="sd">                table. ``k`` must be between 1 and ``num_rows - 1``.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ``ValueError``: ``k`` is not between 1 and ``num_rows - 1``.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A tuple containing two instances of ``Table``.</span>

<span class="sd">        &gt;&gt;&gt; jobs = Table().with_columns(</span>
<span class="sd">        ...     &#39;job&#39;,  make_array(&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;),</span>
<span class="sd">        ...     &#39;wage&#39;, make_array(10, 20, 15, 8))</span>
<span class="sd">        &gt;&gt;&gt; jobs</span>
<span class="sd">        job  | wage</span>
<span class="sd">        a    | 10</span>
<span class="sd">        b    | 20</span>
<span class="sd">        c    | 15</span>
<span class="sd">        d    | 8</span>
<span class="sd">        &gt;&gt;&gt; sample, rest = jobs.split(3)</span>
<span class="sd">        &gt;&gt;&gt; sample # doctest: +SKIP</span>
<span class="sd">        job  | wage</span>
<span class="sd">        c    | 15</span>
<span class="sd">        a    | 10</span>
<span class="sd">        b    | 20</span>
<span class="sd">        &gt;&gt;&gt; rest # doctest: +SKIP</span>
<span class="sd">        job  | wage</span>
<span class="sd">        d    | 8</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_rows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid value of k. k must be between 1 and the&quot;</span>
                             <span class="s2">&quot;number of rows - 1&quot;</span><span class="p">)</span>

        <span class="n">rows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_rows</span><span class="p">)</span>

        <span class="n">first</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">rows</span><span class="p">[:</span><span class="n">k</span><span class="p">])</span>
        <span class="n">rest</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">rows</span><span class="p">[</span><span class="n">k</span><span class="p">:])</span>
        <span class="k">for</span> <span class="n">column_label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_formats</span><span class="p">:</span>
            <span class="n">first</span><span class="o">.</span><span class="n">_formats</span><span class="p">[</span><span class="n">column_label</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_formats</span><span class="p">[</span><span class="n">column_label</span><span class="p">]</span>
            <span class="n">rest</span><span class="o">.</span><span class="n">_formats</span><span class="p">[</span><span class="n">column_label</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_formats</span><span class="p">[</span><span class="n">column_label</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">first</span><span class="p">,</span> <span class="n">rest</span></div>


<div class="viewcode-block" id="Table.with_row"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.with_row.html#datascience.tables.Table.with_row">[docs]</a>    <span class="k">def</span> <span class="nf">with_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a table with an additional row.</span>

<span class="sd">        Args:</span>
<span class="sd">            ``row`` (sequence): A value for each column.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ``ValueError``: If the row length differs from the column count.</span>

<span class="sd">        &gt;&gt;&gt; tiles = Table(make_array(&#39;letter&#39;, &#39;count&#39;, &#39;points&#39;))</span>
<span class="sd">        &gt;&gt;&gt; tiles.with_row([&#39;c&#39;, 2, 3]).with_row([&#39;d&#39;, 4, 2])</span>
<span class="sd">        letter | count | points</span>
<span class="sd">        c      | 2     | 3</span>
<span class="sd">        d      | 4     | 2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Table.with_rows"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.with_rows.html#datascience.tables.Table.with_rows">[docs]</a>    <span class="k">def</span> <span class="nf">with_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rows</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a table with additional rows.</span>

<span class="sd">        Args:</span>
<span class="sd">            ``rows`` (sequence of sequences): Each row has a value per column.</span>

<span class="sd">            If ``rows`` is a 2-d array, its shape must be (_, n) for n columns.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ``ValueError``: If a row length differs from the column count.</span>

<span class="sd">        &gt;&gt;&gt; tiles = Table(make_array(&#39;letter&#39;, &#39;count&#39;, &#39;points&#39;))</span>
<span class="sd">        &gt;&gt;&gt; tiles.with_rows(make_array(make_array(&#39;c&#39;, 2, 3),</span>
<span class="sd">        ...     make_array(&#39;d&#39;, 4, 2)))</span>
<span class="sd">        letter | count | points</span>
<span class="sd">        c      | 2     | 3</span>
<span class="sd">        d      | 4     | 2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_with_columns</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">rows</span><span class="p">)))</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Table.with_column"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.with_column.html#datascience.tables.Table.with_column">[docs]</a>    <span class="k">def</span> <span class="nf">with_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">formatter</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a new table with an additional or replaced column.</span>

<span class="sd">        Args:</span>
<span class="sd">            ``label`` (str): The column label. If an existing label is used,</span>
<span class="sd">                the existing column will be replaced in the new table.</span>

<span class="sd">            ``values`` (single value or sequence): If a single value, every</span>
<span class="sd">                value in the new column is ``values``. If sequence of values,</span>
<span class="sd">                new column takes on values in ``values``.</span>

<span class="sd">            ``formatter`` (single value): Specifies formatter for the new column. Defaults to no formatter.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ``ValueError``: If</span>
<span class="sd">                - ``label`` is not a valid column name</span>
<span class="sd">                - if ``label`` is not of type (str)</span>
<span class="sd">                - ``values`` is a list/array that does not have the same</span>
<span class="sd">                    length as the number of rows in the table.</span>

<span class="sd">        Returns:</span>
<span class="sd">            copy of original table with new or replaced column</span>

<span class="sd">        &gt;&gt;&gt; alphabet = Table().with_column(&#39;letter&#39;, make_array(&#39;c&#39;,&#39;d&#39;))</span>
<span class="sd">        &gt;&gt;&gt; alphabet = alphabet.with_column(&#39;count&#39;, make_array(2, 4))</span>
<span class="sd">        &gt;&gt;&gt; alphabet</span>
<span class="sd">        letter | count</span>
<span class="sd">        c      | 2</span>
<span class="sd">        d      | 4</span>
<span class="sd">        &gt;&gt;&gt; alphabet.with_column(&#39;permutes&#39;, make_array(&#39;a&#39;, &#39;g&#39;))</span>
<span class="sd">        letter | count | permutes</span>
<span class="sd">        c      | 2     | a</span>
<span class="sd">        d      | 4     | g</span>
<span class="sd">        &gt;&gt;&gt; alphabet</span>
<span class="sd">        letter | count</span>
<span class="sd">        c      | 2</span>
<span class="sd">        d      | 4</span>
<span class="sd">        &gt;&gt;&gt; alphabet.with_column(&#39;count&#39;, 1)</span>
<span class="sd">        letter | count</span>
<span class="sd">        c      | 1</span>
<span class="sd">        d      | 1</span>
<span class="sd">        &gt;&gt;&gt; alphabet.with_column(1, make_array(1, 2))</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        ValueError: The column label must be a string, but a int was given</span>
<span class="sd">        &gt;&gt;&gt; alphabet.with_column(&#39;bad_col&#39;, make_array(1))</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        ValueError: Column length mismatch. New column does not have the same number of rows as table.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Ensure that if with_column is called instead of with_columns;</span>
        <span class="c1"># no error is raised.</span>

        <span class="n">new_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">formatter</span> <span class="o">==</span> <span class="p">{}:</span>
            <span class="n">formatter</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">formatter</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">formatter</span> <span class="o">=</span> <span class="n">formatter</span><span class="p">[</span><span class="s2">&quot;formatter&quot;</span><span class="p">]</span>
        <span class="n">new_table</span><span class="o">.</span><span class="n">append_column</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">formatter</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_table</span></div>

<div class="viewcode-block" id="Table.with_columns"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.with_columns.html#datascience.tables.Table.with_columns">[docs]</a>    <span class="k">def</span> <span class="nf">with_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">labels_and_values</span><span class="p">,</span> <span class="o">**</span><span class="n">formatter</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a table with additional or replaced columns.</span>


<span class="sd">        Args:</span>
<span class="sd">            ``labels_and_values``: An alternating list of labels and values </span>
<span class="sd">                or a list of label-value pairs. If one of the labels is in </span>
<span class="sd">                existing table, then every value in the corresponding column is</span>
<span class="sd">                set to that value. If label has only a single value (``int``),</span>
<span class="sd">                every row of corresponding column takes on that value.</span>
<span class="sd">            &#39;&#39;formatter&#39;&#39; (single Formatter value): A single formatter value </span>
<span class="sd">                that will be applied to all columns being added using this </span>
<span class="sd">                function call.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ``ValueError``: If</span>
<span class="sd">                - any label in ``labels_and_values`` is not a valid column</span>
<span class="sd">                    name, i.e if label is not of type (str).</span>
<span class="sd">                - if any value in ``labels_and_values`` is a list/array and</span>
<span class="sd">                    does not have the same length as the number of rows in the</span>
<span class="sd">                    table.</span>
<span class="sd">            ``AssertionError``:</span>
<span class="sd">                - &#39;incorrect columns format&#39;, if passed more than one sequence</span>
<span class="sd">                    (iterables) for  ``labels_and_values``.</span>
<span class="sd">                - &#39;even length sequence required&#39; if missing a pair in</span>
<span class="sd">                    label-value pairs.</span>


<span class="sd">        Returns:</span>
<span class="sd">            Copy of original table with new or replaced columns. Columns added</span>
<span class="sd">            in order of labels. Equivalent to ``with_column(label, value)``</span>
<span class="sd">            when passed only one label-value pair.</span>


<span class="sd">        &gt;&gt;&gt; players = Table().with_columns(&#39;player_id&#39;,</span>
<span class="sd">        ...     make_array(110234, 110235), &#39;wOBA&#39;, make_array(.354, .236))</span>
<span class="sd">        &gt;&gt;&gt; players</span>
<span class="sd">        player_id | wOBA</span>
<span class="sd">        110234    | 0.354</span>
<span class="sd">        110235    | 0.236</span>
<span class="sd">        &gt;&gt;&gt; players = players.with_columns(&#39;salaries&#39;, &#39;N/A&#39;, &#39;season&#39;, 2016)</span>
<span class="sd">        &gt;&gt;&gt; players</span>
<span class="sd">        player_id | wOBA  | salaries | season</span>
<span class="sd">        110234    | 0.354 | N/A      | 2016</span>
<span class="sd">        110235    | 0.236 | N/A      | 2016</span>
<span class="sd">        &gt;&gt;&gt; salaries = Table().with_column(&#39;salary&#39;,</span>
<span class="sd">        ...     make_array(500000, 15500000))</span>
<span class="sd">        &gt;&gt;&gt; players.with_columns(&#39;salaries&#39;, salaries.column(&#39;salary&#39;),</span>
<span class="sd">        ...     &#39;bonus&#39;, make_array(6, 1), formatter=_formats.CurrencyFormatter)</span>
<span class="sd">        player_id | wOBA  | salaries    | season | bonus</span>
<span class="sd">        110234    | 0.354 | $500,000    | 2016   | $6</span>
<span class="sd">        110235    | 0.236 | $15,500,000 | 2016   | $1</span>
<span class="sd">        &gt;&gt;&gt; players.with_columns(2, make_array(&#39;$600,000&#39;, &#39;$20,000,000&#39;))</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        ValueError: The column label must be a string, but a int was given</span>
<span class="sd">        &gt;&gt;&gt; players.with_columns(&#39;salaries&#39;, make_array(&#39;$600,000&#39;))</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        ValueError: Column length mismatch. New column does not have the same number of rows as table.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Table</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Use Table().with_columns() to create a new table, </span><span class="se">\</span>
<span class="s1">                not Table.with_columns()&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels_and_values</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">labels_and_values</span> <span class="o">=</span> <span class="n">labels_and_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">labels_and_values</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Mapping</span><span class="p">):</span>
            <span class="n">labels_and_values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">labels_and_values</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">labels_and_values</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">):</span>
            <span class="n">labels_and_values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">labels_and_values</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">labels_and_values</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="n">first</span> <span class="o">=</span> <span class="n">labels_and_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="s1">&#39;__iter__&#39;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">labels_and_values</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">pair</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;incorrect columns format&#39;</span>
            <span class="n">labels_and_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">labels_and_values</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pair</span><span class="p">]</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels_and_values</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Even length sequence required&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels_and_values</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">label</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="n">labels_and_values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">labels_and_values</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_column</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">formatter</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

        

<div class="viewcode-block" id="Table.relabeled"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.relabeled.html#datascience.tables.Table.relabeled">[docs]</a>    <span class="k">def</span> <span class="nf">relabeled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">new_label</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a new table with ``label`` specifying column label(s)</span>
<span class="sd">        replaced by corresponding ``new_label``.</span>

<span class="sd">        Args:</span>
<span class="sd">            ``label`` -- (str or array of str) The label(s) of</span>
<span class="sd">                columns to be changed.</span>

<span class="sd">            ``new_label`` -- (str or array of str): The new label(s) of</span>
<span class="sd">                columns to be changed. Same number of elements as label.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ``ValueError`` -- if ``label`` does not exist in</span>
<span class="sd">                table, or if the ``label`` and ``new_label`` are not not of</span>
<span class="sd">                equal length. Also, raised if ``label`` and/or ``new_label``</span>
<span class="sd">                are not ``str``.</span>

<span class="sd">        Returns:</span>
<span class="sd">            New table with ``new_label`` in place of ``label``.</span>

<span class="sd">        &gt;&gt;&gt; tiles = Table().with_columns(&#39;letter&#39;, make_array(&#39;c&#39;, &#39;d&#39;),</span>
<span class="sd">        ...    &#39;count&#39;, make_array(2, 4))</span>
<span class="sd">        &gt;&gt;&gt; tiles</span>
<span class="sd">        letter | count</span>
<span class="sd">        c      | 2</span>
<span class="sd">        d      | 4</span>
<span class="sd">        &gt;&gt;&gt; tiles.relabeled(&#39;count&#39;, &#39;number&#39;)</span>
<span class="sd">        letter | number</span>
<span class="sd">        c      | 2</span>
<span class="sd">        d      | 4</span>
<span class="sd">        &gt;&gt;&gt; tiles  # original table unmodified</span>
<span class="sd">        letter | count</span>
<span class="sd">        c      | 2</span>
<span class="sd">        d      | 4</span>
<span class="sd">        &gt;&gt;&gt; tiles.relabeled(make_array(&#39;letter&#39;, &#39;count&#39;),</span>
<span class="sd">        ...   make_array(&#39;column1&#39;, &#39;column2&#39;))</span>
<span class="sd">        column1 | column2</span>
<span class="sd">        c       | 2</span>
<span class="sd">        d       | 4</span>
<span class="sd">        &gt;&gt;&gt; tiles.relabeled(make_array(&#39;letter&#39;, &#39;number&#39;),</span>
<span class="sd">        ...  make_array(&#39;column1&#39;, &#39;column2&#39;))</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        ValueError: Invalid labels. Column labels must already exist in table in order to be replaced.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">copy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">copy</span><span class="o">.</span><span class="n">relabel</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">new_label</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">copy</span></div>

    <span class="c1"># Deprecated</span>
    <span class="k">def</span> <span class="nf">with_relabeling</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;with_relabeling is deprecated; use relabeled&quot;</span><span class="p">,</span> <span class="ne">FutureWarning</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">relabeled</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

<div class="viewcode-block" id="Table.bin"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.bin.html#datascience.tables.Table.bin">[docs]</a>    <span class="k">def</span> <span class="nf">bin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">columns</span><span class="p">,</span> <span class="o">**</span><span class="n">vargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Group values by bin and compute counts per bin by column.</span>

<span class="sd">        By default, bins are chosen to contain all values in all columns. The</span>
<span class="sd">        following named arguments from numpy.histogram can be applied to</span>
<span class="sd">        specialize bin widths:</span>

<span class="sd">        If the original table has n columns, the resulting binned table has</span>
<span class="sd">        n+1 columns, where column 0 contains the lower bound of each bin.</span>

<span class="sd">        Args:</span>
<span class="sd">            ``columns`` (str or int): Labels or indices of columns to be</span>
<span class="sd">                binned. If empty, all columns are binned.</span>

<span class="sd">            ``bins`` (int or sequence of scalars): If bins is an int,</span>
<span class="sd">                it defines the number of equal-width bins in the given range</span>
<span class="sd">                (10, by default). If bins is a sequence, it defines the bin</span>
<span class="sd">                edges, including the rightmost edge, allowing for non-uniform</span>
<span class="sd">                bin widths.</span>

<span class="sd">            ``range`` ((float, float)): The lower and upper range of</span>
<span class="sd">                the bins. If not provided, range contains all values in the</span>
<span class="sd">                table. Values outside the range are ignored.</span>

<span class="sd">            ``density`` (bool): If False, the result will contain the number of</span>
<span class="sd">                samples in each bin. If True, the result is the value of the</span>
<span class="sd">                probability density function at the bin, normalized such that</span>
<span class="sd">                the integral over the range is 1. Note that the sum of the</span>
<span class="sd">                histogram values will not be equal to 1 unless bins of unity</span>
<span class="sd">                width are chosen; it is not a probability mass function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">columns</span><span class="p">:</span>
            <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="o">*</span><span class="n">columns</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;normed&#39;</span> <span class="ow">in</span> <span class="n">vargs</span><span class="p">:</span>
            <span class="n">vargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;density&#39;</span><span class="p">,</span> <span class="n">vargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;normed&#39;</span><span class="p">))</span>
        <span class="n">density</span> <span class="o">=</span> <span class="n">vargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;density&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">tag</span> <span class="o">=</span> <span class="s1">&#39;density&#39;</span> <span class="k">if</span> <span class="n">density</span> <span class="k">else</span> <span class="s1">&#39;count&#39;</span>

        <span class="n">cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span> <span class="o">**</span><span class="n">vargs</span><span class="p">)</span>

        <span class="n">binned</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)()</span><span class="o">.</span><span class="n">with_column</span><span class="p">(</span><span class="s1">&#39;bin&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">:</span>
            <span class="n">counts</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">label</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="n">density</span><span class="p">)</span>
            <span class="n">binned</span><span class="p">[</span><span class="n">label</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">tag</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">binned</span></div>

<div class="viewcode-block" id="Table.move_column"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.move_column.html#datascience.tables.Table.move_column">[docs]</a>    <span class="k">def</span> <span class="nf">move_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a new table with specified column moved to the specified column index.&quot;&quot;&quot;</span>
        <span class="n">table</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)()</span>
        <span class="n">col_order</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">)</span>
        <span class="n">label_idx</span> <span class="o">=</span> <span class="n">col_order</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_as_label</span><span class="p">(</span><span class="n">label</span><span class="p">))</span>
        <span class="n">col_to_move</span> <span class="o">=</span> <span class="n">col_order</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">label_idx</span><span class="p">)</span>
        <span class="n">col_order</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">col_to_move</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">col_order</span><span class="p">:</span>
            <span class="n">table</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">table</span></div>

    <span class="c1">##########################</span>
    <span class="c1"># Exporting / Displaying #</span>
    <span class="c1">##########################</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_str_rows</span><span class="p">)</span>

    <span class="fm">__repr__</span> <span class="o">=</span> <span class="fm">__str__</span>

    <span class="k">def</span> <span class="nf">_repr_html_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_html</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_str_rows</span><span class="p">)</span>

<div class="viewcode-block" id="Table.show"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.show.html#datascience.tables.Table.show">[docs]</a>    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_rows</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Display the table.&quot;&quot;&quot;</span>
        <span class="n">IPython</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">IPython</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">as_html</span><span class="p">(</span><span class="n">max_rows</span><span class="p">)))</span></div>

    <span class="n">max_str_rows</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_use_html_if_available</span><span class="p">(</span><span class="n">format_fn</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Use the value&#39;s HTML rendering if available, overriding format_fn.&quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">format_using_as_html</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">label</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s1">&#39;as_html&#39;</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">v</span><span class="o">.</span><span class="n">as_html</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">format_fn</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">format_using_as_html</span>

    <span class="k">def</span> <span class="nf">_get_column_formatters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_rows</span><span class="p">,</span> <span class="n">as_html</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return one value formatting function per column.</span>

<span class="sd">        Each function has the signature f(value, label=False) -&gt; str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">formats</span> <span class="o">=</span> <span class="p">{</span><span class="n">s</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_formats</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">formatter</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">}</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="n">fmts</span> <span class="o">=</span> <span class="p">[</span><span class="n">formats</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">format_column</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">[:</span><span class="n">max_rows</span><span class="p">])</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">as_html</span><span class="p">:</span>
            <span class="n">fmts</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_use_html_if_available</span><span class="p">,</span> <span class="n">fmts</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">fmts</span>

<div class="viewcode-block" id="Table.as_text"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.as_text.html#datascience.tables.Table.as_text">[docs]</a>    <span class="k">def</span> <span class="nf">as_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_rows</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot; | &quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Format table as text.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">max_rows</span> <span class="ow">or</span> <span class="n">max_rows</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_rows</span><span class="p">:</span>
            <span class="n">max_rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_rows</span>
        <span class="n">omitted</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_rows</span> <span class="o">-</span> <span class="n">max_rows</span><span class="p">)</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="n">fmts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_column_formatters</span><span class="p">(</span><span class="n">max_rows</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="p">[[</span><span class="n">fmt</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">fmt</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">fmts</span><span class="p">,</span> <span class="n">labels</span><span class="p">)]]</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">islice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">,</span> <span class="n">max_rows</span><span class="p">):</span>
            <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">f</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">fmts</span><span class="p">)])</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">omitted</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;... (</span><span class="si">{}</span><span class="s1"> rows omitted)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">omitted</span><span class="p">))</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">])</span></div>

<div class="viewcode-block" id="Table.as_html"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.as_html.html#datascience.tables.Table.as_html">[docs]</a>    <span class="k">def</span> <span class="nf">as_html</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_rows</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Format table as HTML.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">max_rows</span> <span class="ow">or</span> <span class="n">max_rows</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_rows</span><span class="p">:</span>
            <span class="n">max_rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_rows</span>
        <span class="n">omitted</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_rows</span> <span class="o">-</span> <span class="n">max_rows</span><span class="p">)</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;&lt;thead&gt;&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;&lt;tr&gt;&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;&lt;th&gt;&#39;</span> <span class="o">+</span> <span class="n">label</span> <span class="o">+</span> <span class="s1">&#39;&lt;/th&gt;&#39;</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">)),</span>
            <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;&lt;/tr&gt;&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;&lt;/thead&gt;&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;&lt;tbody&gt;&#39;</span><span class="p">),</span>
        <span class="p">]</span>
        <span class="n">fmts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_column_formatters</span><span class="p">(</span><span class="n">max_rows</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">islice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">,</span> <span class="n">max_rows</span><span class="p">):</span>
            <span class="n">lines</span> <span class="o">+=</span> <span class="p">[</span>
                <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;&lt;tr&gt;&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;&lt;td&gt;&#39;</span> <span class="o">+</span> <span class="n">fmt</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&lt;/td&gt;&#39;</span> <span class="k">for</span>
                    <span class="n">v</span><span class="p">,</span> <span class="n">fmt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">fmts</span><span class="p">))),</span>
                <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;&lt;/tr&gt;&#39;</span><span class="p">),</span>
            <span class="p">]</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;&lt;/tbody&gt;&#39;</span><span class="p">))</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;&lt;/table&gt;&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">omitted</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;&lt;p&gt;... (</span><span class="si">{}</span><span class="s1"> rows omitted)&lt;/p&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">omitted</span><span class="p">)))</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">indent</span> <span class="o">*</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">text</span> <span class="k">for</span> <span class="n">indent</span><span class="p">,</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">)</span></div>

<div class="viewcode-block" id="Table.index_by"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.index_by.html#datascience.tables.Table.index_by">[docs]</a>    <span class="k">def</span> <span class="nf">index_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_or_label</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a dict keyed by values in a column that contains lists of</span>
<span class="sd">        rows corresponding to each value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_column</span><span class="p">(</span><span class="n">column_or_label</span><span class="p">)</span>
        <span class="n">index</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">key_transformed</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">key_transformed</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="n">has_null</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">key_transformed</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">has_null</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">key_transformed</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="n">pandas</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">key_transformed</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                        <span class="n">key_transformed</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="n">key</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">key_transformed</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">key_transformed</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">key_transformed</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">index</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">index</span></div>

    <span class="k">def</span> <span class="nf">_multi_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">columns_or_labels</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dict keyed by a tuple of the values that correspond to</span>
<span class="sd">        the selected COLUMNS_OR_LABELS, with values corresponding to &quot;&quot;&quot;</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_column</span><span class="p">(</span><span class="n">col</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns_or_labels</span><span class="p">]</span>
        <span class="n">index</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">columns</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">):</span>
            <span class="n">index</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">index</span>

<div class="viewcode-block" id="Table.to_df"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.to_df.html#datascience.tables.Table.to_df">[docs]</a>    <span class="k">def</span> <span class="nf">to_df</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert the table to a Pandas DataFrame.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">)</span></div>

<div class="viewcode-block" id="Table.to_csv"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.to_csv.html#datascience.tables.Table.to_csv">[docs]</a>    <span class="k">def</span> <span class="nf">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a CSV file with the provided filename.</span>

<span class="sd">        The CSV is created in such a way that if we run</span>
<span class="sd">        ``table.to_csv(&#39;my_table.csv&#39;)`` we can recreate the same table with</span>
<span class="sd">        ``Table.read_table(&#39;my_table.csv&#39;)``.</span>

<span class="sd">        Args:</span>
<span class="sd">            ``filename`` (str): The filename of the output CSV file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None, outputs a file with name ``filename``.</span>

<span class="sd">        &gt;&gt;&gt; jobs = Table().with_columns(</span>
<span class="sd">        ...     &#39;job&#39;,  make_array(&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;),</span>
<span class="sd">        ...     &#39;wage&#39;, make_array(10, 20, 15, 8))</span>
<span class="sd">        &gt;&gt;&gt; jobs</span>
<span class="sd">        job  | wage</span>
<span class="sd">        a    | 10</span>
<span class="sd">        b    | 20</span>
<span class="sd">        c    | 15</span>
<span class="sd">        d    | 8</span>
<span class="sd">        &gt;&gt;&gt; jobs.to_csv(&#39;my_table.csv&#39;) # doctest: +SKIP</span>
<span class="sd">        &lt;outputs a file called my_table.csv in the current directory&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># index=False avoids row numbers in the output</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_df</span><span class="p">()</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="Table.to_array"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.to_array.html#datascience.tables.Table.to_array">[docs]</a>    <span class="k">def</span> <span class="nf">to_array</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert the table to a structured NumPy array.&quot;&quot;&quot;</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">dtype</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">))))</span>
        <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dt</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">:</span>
            <span class="n">arr</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">arr</span></div>

    <span class="c1">##################</span>
    <span class="c1"># Visualizations #</span>
    <span class="c1">##################</span>

    <span class="c1"># As RGB tuples</span>
    <span class="n">chart_colors</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">30</span><span class="o">/</span><span class="mi">256</span><span class="p">,</span> <span class="mi">66</span><span class="o">/</span><span class="mi">256</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">200</span><span class="o">/</span><span class="mi">256</span><span class="p">,</span> <span class="mi">44</span><span class="o">/</span><span class="mi">256</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">150</span><span class="o">/</span><span class="mi">256</span><span class="p">,</span> <span class="mi">207</span><span class="o">/</span><span class="mi">256</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">30</span><span class="o">/</span><span class="mi">256</span><span class="p">,</span> <span class="mi">100</span><span class="o">/</span><span class="mi">256</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">172</span><span class="o">/</span><span class="mi">256</span><span class="p">,</span> <span class="mi">60</span><span class="o">/</span><span class="mi">256</span><span class="p">,</span> <span class="mi">72</span><span class="o">/</span><span class="mi">256</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">chart_colors</span> <span class="o">+=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">tuple</span><span class="p">((</span><span class="n">x</span><span class="o">+</span><span class="mf">0.7</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">chart_colors</span><span class="p">)</span>

    <span class="n">default_alpha</span> <span class="o">=</span> <span class="mf">0.7</span>

    <span class="n">default_options</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="n">default_alpha</span><span class="p">,</span>
    <span class="p">}</span>

<div class="viewcode-block" id="Table.plot"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.plot.html#datascience.tables.Table.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_for_xticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overlay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="o">**</span><span class="n">vargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot line charts for the table.</span>

<span class="sd">        Args:</span>
<span class="sd">            column_for_xticks (``str/array``): A column containing x-axis labels</span>

<span class="sd">        Kwargs:</span>
<span class="sd">            overlay (bool): create a chart with one color per data column;</span>
<span class="sd">                if False, each plot will be displayed separately.</span>

<span class="sd">            vargs: Additional arguments that get passed into `plt.plot`.</span>
<span class="sd">                See http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.plot</span>
<span class="sd">                for additional arguments that can be passed into vargs.</span>
<span class="sd">        Raises:</span>
<span class="sd">            ValueError -- Every selected column must be numerical.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Returns a line plot (connected scatter). Each plot is labeled using</span>
<span class="sd">            the values in `column_for_xticks` and one plot is produced for all</span>
<span class="sd">            other columns in self (or for the columns designated by `select`).</span>

<span class="sd">        &gt;&gt;&gt; table = Table().with_columns(</span>
<span class="sd">        ...     &#39;days&#39;,  make_array(0, 1, 2, 3, 4, 5),</span>
<span class="sd">        ...     &#39;price&#39;, make_array(90.5, 90.00, 83.00, 95.50, 82.00, 82.00),</span>
<span class="sd">        ...     &#39;projection&#39;, make_array(90.75, 82.00, 82.50, 82.50, 83.00, 82.50))</span>
<span class="sd">        &gt;&gt;&gt; table</span>
<span class="sd">        days | price | projection</span>
<span class="sd">        0    | 90.5  | 90.75</span>
<span class="sd">        1    | 90    | 82</span>
<span class="sd">        2    | 83    | 82.5</span>
<span class="sd">        3    | 95.5  | 82.5</span>
<span class="sd">        4    | 82    | 83</span>
<span class="sd">        5    | 82    | 82.5</span>
<span class="sd">        &gt;&gt;&gt; table.plot(&#39;days&#39;) # doctest: +SKIP</span>
<span class="sd">        &lt;line graph with days as x-axis and lines for price and projection&gt;</span>
<span class="sd">        &gt;&gt;&gt; table.plot(&#39;days&#39;, overlay=False) # doctest: +SKIP</span>
<span class="sd">        &lt;line graph with days as x-axis and line for price&gt;</span>
<span class="sd">        &lt;line graph with days as x-axis and line for projection&gt;</span>
<span class="sd">        &gt;&gt;&gt; table.plot(&#39;days&#39;, &#39;price&#39;) # doctest: +SKIP</span>
<span class="sd">        &lt;line graph with days as x-axis and line for price&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">vargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">column_for_xticks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">x_data</span><span class="p">,</span> <span class="n">y_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_split_column_and_labels</span><span class="p">(</span><span class="n">column_for_xticks</span><span class="p">)</span>
            <span class="n">x_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_as_label</span><span class="p">(</span><span class="n">column_for_xticks</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x_data</span><span class="p">,</span> <span class="n">y_labels</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span>
            <span class="n">x_label</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">select</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">y_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_as_labels</span><span class="p">(</span><span class="n">select</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">x_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span>
            <span class="n">x_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">x_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">label</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="bp">self</span><span class="p">[</span><span class="n">label</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_visualize</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">y_labels</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">overlay</span><span class="p">,</span> <span class="n">draw</span><span class="p">,</span> <span class="n">_vertical_x</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">)</span></div>

<div class="viewcode-block" id="Table.bar"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.bar.html#datascience.tables.Table.bar">[docs]</a>    <span class="k">def</span> <span class="nf">bar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_for_categories</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overlay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="o">**</span><span class="n">vargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot bar charts for the table.</span>

<span class="sd">        Each plot is labeled using the values in `column_for_categories` and</span>
<span class="sd">        one plot is produced for every other column (or for the columns</span>
<span class="sd">        designated by `select`).</span>

<span class="sd">        Every selected column except `column_for_categories` must be numerical.</span>

<span class="sd">        Args:</span>
<span class="sd">            column_for_categories (str): A column containing x-axis categories</span>

<span class="sd">        Kwargs:</span>
<span class="sd">            overlay (bool): create a chart with one color per data column;</span>
<span class="sd">                if False, each will be displayed separately.</span>

<span class="sd">            vargs: Additional arguments that get passed into `plt.bar`.</span>
<span class="sd">                See http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.bar</span>
<span class="sd">                for additional arguments that can be passed into vargs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># Matplotlib tries to center the labels, but we already handle that</span>
        <span class="c1"># TODO consider changing the custom centering code and using matplotlib&#39;s default</span>
        <span class="n">vargs</span><span class="p">[</span><span class="s1">&#39;align&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;edge&#39;</span>
        <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">vargs</span><span class="p">)</span>

        <span class="n">xticks</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_split_column_and_labels</span><span class="p">(</span><span class="n">column_for_categories</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">select</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_as_labels</span><span class="p">(</span><span class="n">select</span><span class="p">)</span>

        <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_rows</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">index</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="bp">self</span><span class="p">[</span><span class="n">label</span><span class="p">],</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">annotate</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">ticks</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">ticks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="p">:</span>
                <span class="n">tick_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">ticks</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">)]</span> <span class="k">if</span> <span class="mi">0</span><span class="o">&lt;=</span><span class="n">l</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">axis</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">()]</span>
                <span class="n">axis</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">tick_labels</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;ultra-condensed&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_visualize</span><span class="p">(</span><span class="n">column_for_categories</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">xticks</span><span class="p">,</span> <span class="n">overlay</span><span class="p">,</span> <span class="n">draw</span><span class="p">,</span> <span class="n">annotate</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">)</span></div>


<div class="viewcode-block" id="Table.group_bar"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.group_bar.html#datascience.tables.Table.group_bar">[docs]</a>    <span class="k">def</span> <span class="nf">group_bar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_label</span><span class="p">,</span> <span class="o">**</span><span class="n">vargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot a bar chart for the table.</span>

<span class="sd">        The values of the specified column are grouped and counted, and one</span>
<span class="sd">        bar is produced for each group.</span>

<span class="sd">        Note: This differs from ``bar`` in that there is no need to specify</span>
<span class="sd">        bar heights; the height of a category&#39;s bar is the number of copies</span>
<span class="sd">        of that category in the given column.  This method behaves more like</span>
<span class="sd">        ``hist`` in that regard, while ``bar`` behaves more like ``plot`` or</span>
<span class="sd">        ``scatter`` (which require the height of each point to be specified).</span>

<span class="sd">        Args:</span>
<span class="sd">            ``column_label`` (str or int): The name or index of a column</span>

<span class="sd">        Kwargs:</span>
<span class="sd">            overlay (bool): create a chart with one color per data column;</span>
<span class="sd">                if False, each will be displayed separately.</span>

<span class="sd">            width (float): The width of the plot, in inches</span>
<span class="sd">            height (float): The height of the plot, in inches</span>

<span class="sd">            vargs: Additional arguments that get passed into `plt.bar`.</span>
<span class="sd">                See http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.bar</span>
<span class="sd">                for additional arguments that can be passed into vargs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="n">column_label</span><span class="p">)</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">column_label</span><span class="p">,</span> <span class="o">**</span><span class="n">vargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Table.barh"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.barh.html#datascience.tables.Table.barh">[docs]</a>    <span class="k">def</span> <span class="nf">barh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_for_categories</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overlay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="o">**</span><span class="n">vargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot horizontal bar charts for the table.</span>

<span class="sd">        Args:</span>
<span class="sd">            ``column_for_categories`` (``str``): A column containing y-axis categories</span>
<span class="sd">                used to create buckets for bar chart.</span>

<span class="sd">        Kwargs:</span>
<span class="sd">            overlay (bool): create a chart with one color per data column;</span>
<span class="sd">                if False, each will be displayed separately.</span>

<span class="sd">            vargs: Additional arguments that get passed into `plt.barh`.</span>
<span class="sd">                See http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.barh</span>
<span class="sd">                for additional arguments that can be passed into vargs.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError -- Every selected except column for ``column_for_categories``</span>
<span class="sd">                must be numerical.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Horizontal bar graph with buckets specified by ``column_for_categories``.</span>
<span class="sd">            Each plot is labeled using the values in ``column_for_categories``</span>
<span class="sd">            and one plot is produced for every other column (or for the columns</span>
<span class="sd">            designated by ``select``).</span>

<span class="sd">        &gt;&gt;&gt; t = Table().with_columns(</span>
<span class="sd">        ...     &#39;Furniture&#39;, make_array(&#39;chairs&#39;, &#39;tables&#39;, &#39;desks&#39;),</span>
<span class="sd">        ...     &#39;Count&#39;, make_array(6, 1, 2),</span>
<span class="sd">        ...     &#39;Price&#39;, make_array(10, 20, 30)</span>
<span class="sd">        ...     )</span>
<span class="sd">        &gt;&gt;&gt; t</span>
<span class="sd">        Furniture | Count | Price</span>
<span class="sd">        chairs    | 6     | 10</span>
<span class="sd">        tables    | 1     | 20</span>
<span class="sd">        desks     | 2     | 30</span>
<span class="sd">        &gt;&gt;&gt; furniture_table.barh(&#39;Furniture&#39;) # doctest: +SKIP</span>
<span class="sd">        &lt;bar graph with furniture as categories and bars for count and price&gt;</span>
<span class="sd">        &gt;&gt;&gt; furniture_table.barh(&#39;Furniture&#39;, &#39;Price&#39;) # doctest: +SKIP</span>
<span class="sd">        &lt;bar graph with furniture as categories and bars for price&gt;</span>
<span class="sd">        &gt;&gt;&gt; furniture_table.barh(&#39;Furniture&#39;, make_array(1, 2)) # doctest: +SKIP</span>
<span class="sd">        &lt;bar graph with furniture as categories and bars for count and price&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="c1"># Matplotlib tries to center the labels, but we already handle that</span>
        <span class="c1"># TODO consider changing the custom centering code and using matplotlib&#39;s default</span>
        <span class="n">vargs</span><span class="p">[</span><span class="s1">&#39;align&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;edge&#39;</span>
        <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">vargs</span><span class="p">)</span>

        <span class="n">yticks</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_split_column_and_labels</span><span class="p">(</span><span class="n">column_for_categories</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">select</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_as_labels</span><span class="p">(</span><span class="n">select</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>

        <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_rows</span><span class="p">)</span>
        <span class="n">margin</span> <span class="o">=</span> <span class="mf">0.1</span>
        <span class="n">bwidth</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">margin</span>
        <span class="k">if</span> <span class="n">overlay</span><span class="p">:</span>
            <span class="n">bwidth</span> <span class="o">/=</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;height&#39;</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
            <span class="n">height</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">height</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">overlay</span><span class="p">:</span>
                <span class="n">ypos</span> <span class="o">=</span> <span class="n">index</span> <span class="o">+</span> <span class="n">margin</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">margin</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">labels</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">label</span><span class="p">))</span><span class="o">/</span><span class="n">n</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ypos</span> <span class="o">=</span> <span class="n">index</span>
            <span class="c1"># barh plots entries in reverse order from bottom to top</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">ypos</span><span class="p">,</span> <span class="bp">self</span><span class="p">[</span><span class="n">label</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">bwidth</span><span class="p">,</span>  <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>

        <span class="n">ylabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_as_label</span><span class="p">(</span><span class="n">column_for_categories</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">annotate</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">ticks</span><span class="p">):</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">index</span><span class="o">+</span><span class="mf">0.5</span><span class="p">)</span> <span class="c1"># Center labels on bars</span>
            <span class="c1"># barh plots entries in reverse order from bottom to top</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">ticks</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;ultra-condensed&#39;</span><span class="p">)</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">axis</span><span class="o">.</span><span class="n">get_ylabel</span><span class="p">())</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_visualize</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">yticks</span><span class="p">,</span> <span class="n">overlay</span><span class="p">,</span> <span class="n">draw</span><span class="p">,</span> <span class="n">annotate</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">)</span></div>


<div class="viewcode-block" id="Table.group_barh"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.group_barh.html#datascience.tables.Table.group_barh">[docs]</a>    <span class="k">def</span> <span class="nf">group_barh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_label</span><span class="p">,</span> <span class="o">**</span><span class="n">vargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot a horizontal bar chart for the table.</span>

<span class="sd">        The values of the specified column are grouped and counted, and one</span>
<span class="sd">        bar is produced for each group.</span>

<span class="sd">        Note: This differs from ``barh`` in that there is no need to specify</span>
<span class="sd">        bar heights; the size of a category&#39;s bar is the number of copies</span>
<span class="sd">        of that category in the given column.  This method behaves more like</span>
<span class="sd">        ``hist`` in that regard, while ``barh`` behaves more like ``plot`` or</span>
<span class="sd">        ``scatter`` (which require the second coordinate of each point to be</span>
<span class="sd">        specified in another column).</span>

<span class="sd">        Args:</span>
<span class="sd">            ``column_label`` (str or int): The name or index of a column</span>

<span class="sd">        Kwargs:</span>
<span class="sd">            overlay (bool): create a chart with one color per data column;</span>
<span class="sd">                if False, each will be displayed separately.</span>

<span class="sd">            width (float): The width of the plot, in inches</span>
<span class="sd">            height (float): The height of the plot, in inches</span>

<span class="sd">            vargs: Additional arguments that get passed into `plt.bar`.</span>
<span class="sd">                See http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.bar</span>
<span class="sd">                for additional arguments that can be passed into vargs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="n">column_label</span><span class="p">)</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">column_label</span><span class="p">,</span> <span class="o">**</span><span class="n">vargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Table.scatter"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.scatter.html#datascience.tables.Table.scatter">[docs]</a>    <span class="k">def</span> <span class="nf">scatter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_for_x</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overlay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fit_line</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">group</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sizes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
        <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">vargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates scatterplots, optionally adding a line of best fit.</span>

<span class="sd">        Args:</span>
<span class="sd">            ``column_for_x`` (``str``): The column to use for the x-axis values</span>
<span class="sd">                and label of the scatter plots.</span>

<span class="sd">        Kwargs:</span>
<span class="sd">            ``overlay`` (``bool``): If true, creates a chart with one color</span>
<span class="sd">                per data column; if False, each plot will be displayed separately.</span>

<span class="sd">            ``fit_line`` (``bool``): draw a line of best fit for each set of points.</span>

<span class="sd">            ``vargs``: Additional arguments that get passed into `plt.scatter`.</span>
<span class="sd">                See http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.scatter</span>
<span class="sd">                for additional arguments that can be passed into vargs. These</span>
<span class="sd">                include: `marker` and `norm`, to name a couple.</span>

<span class="sd">            ``group``: A column of categories to be used for coloring dots per </span>
<span class="sd">                each category grouping.</span>

<span class="sd">            ``labels``: A column of text labels to annotate dots.</span>

<span class="sd">            ``sizes``:  A column of values to set the relative areas of dots.</span>

<span class="sd">            ``s``: Size of dots. If sizes is also provided, then dots will be</span>
<span class="sd">                in the range 0 to 2 * s.</span>

<span class="sd">            ``colors``: (deprecated) A synonym for ``group``. Retained</span>
<span class="sd">                temporarily for backwards compatibility. This argument</span>
<span class="sd">                will be removed in future releases.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError -- Every column, ``column_for_x`` or ``select``, must be numerical</span>

<span class="sd">        Returns:</span>
<span class="sd">            Scatter plot of values of ``column_for_x`` plotted against</span>
<span class="sd">            values for all other columns in self. Each plot uses the values in</span>
<span class="sd">            `column_for_x` for horizontal positions. One plot is produced for</span>
<span class="sd">            all other columns in self as y (or for the columns designated by</span>
<span class="sd">            `select`).</span>


<span class="sd">        &gt;&gt;&gt; table = Table().with_columns(</span>
<span class="sd">        ...     &#39;x&#39;, make_array(9, 3, 3, 1),</span>
<span class="sd">        ...     &#39;y&#39;, make_array(1, 2, 2, 10),</span>
<span class="sd">        ...     &#39;z&#39;, make_array(3, 4, 5, 6))</span>
<span class="sd">        &gt;&gt;&gt; table</span>
<span class="sd">        x    | y    | z</span>
<span class="sd">        9    | 1    | 3</span>
<span class="sd">        3    | 2    | 4</span>
<span class="sd">        3    | 2    | 5</span>
<span class="sd">        1    | 10   | 6</span>
<span class="sd">        &gt;&gt;&gt; table.scatter(&#39;x&#39;) # doctest: +SKIP</span>
<span class="sd">        &lt;scatterplot of values in y and z on x&gt;</span>

<span class="sd">        &gt;&gt;&gt; table.scatter(&#39;x&#39;, overlay=False) # doctest: +SKIP</span>
<span class="sd">        &lt;scatterplot of values in y on x&gt;</span>
<span class="sd">        &lt;scatterplot of values in z on x&gt;</span>

<span class="sd">        &gt;&gt;&gt; table.scatter(&#39;x&#39;, fit_line=True) # doctest: +SKIP</span>
<span class="sd">        &lt;scatterplot of values in y and z on x with lines of best fit&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">vargs</span><span class="p">)</span>

        <span class="n">x_data</span><span class="p">,</span> <span class="n">y_labels</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">_split_column_and_labels</span><span class="p">(</span><span class="n">column_for_x</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">group</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">colors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">group</span> <span class="o">!=</span> <span class="n">colors</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Do not pass both colors and group to scatter().&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">group</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">colors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Backward compatibility</span>
            <span class="n">group</span> <span class="o">=</span> <span class="n">colors</span>
            <span class="c1"># TODO: In a future release, warn that this is deprecated.</span>
            <span class="c1"># Deprecated</span>
            <span class="c1"># warnings.warn(&quot;scatter(colors=x) is deprecated. Use scatter(group=x)&quot;, FutureWarning)</span>
        <span class="k">if</span> <span class="n">group</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">y_labels</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_as_label</span><span class="p">(</span><span class="n">group</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">sizes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">y_labels</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_as_label</span><span class="p">(</span><span class="n">sizes</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">select</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">y_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_as_labels</span><span class="p">(</span><span class="n">select</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_labels</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">group</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">overlay</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Group and overlay are incompatible in a scatter&quot;</span><span class="p">)</span>
            <span class="n">overlay</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">group</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">colored</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">group</span><span class="p">)))</span>
                <span class="n">color_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">islice</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">cycle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chart_colors</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">colored</span><span class="p">)))</span>
                <span class="n">color_map</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">colored</span><span class="p">,</span> <span class="n">color_list</span><span class="p">))</span>
                <span class="n">color</span> <span class="o">=</span> <span class="p">[</span><span class="n">color_map</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">group</span><span class="p">)]</span>
            <span class="k">elif</span> <span class="s1">&#39;color&#39;</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
                <span class="n">color</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">)</span>
            <span class="n">y_data</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">sizes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">max_size</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">sizes</span><span class="p">])</span> <span class="o">**</span> <span class="mf">0.5</span>
                <span class="n">size</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">s</span> <span class="o">*</span> <span class="bp">self</span><span class="p">[</span><span class="n">sizes</span><span class="p">]</span> <span class="o">**</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="n">max_size</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">size</span> <span class="o">=</span> <span class="n">s</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">fit_line</span><span class="p">:</span>
                <span class="n">m</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="bp">self</span><span class="p">[</span><span class="n">label</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">minx</span><span class="p">,</span> <span class="n">maxx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x_data</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span>
                <span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">minx</span><span class="p">,</span><span class="n">maxx</span><span class="p">],[</span><span class="n">m</span><span class="o">*</span><span class="n">minx</span><span class="o">+</span><span class="n">b</span><span class="p">,</span><span class="n">m</span><span class="o">*</span><span class="n">maxx</span><span class="o">+</span><span class="n">b</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="bp">self</span><span class="p">[</span><span class="n">labels</span><span class="p">]):</span>
                    <span class="n">axis</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span>
                        <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
                        <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span>
                        <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round,pad=0.5&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">),</span>
                        <span class="n">arrowprops</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span> <span class="o">=</span> <span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">connectionstyle</span> <span class="o">=</span> <span class="s1">&#39;arc3,rad=0&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">group</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">mpatches</span>
                <span class="n">group_col_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_as_label</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
                <span class="n">patches</span> <span class="o">=</span> <span class="p">[</span><span class="n">mpatches</span><span class="o">.</span><span class="n">Patch</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">=</span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">group_col_name</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span> \
                    <span class="k">for</span> <span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="ow">in</span> <span class="n">color_map</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
                <span class="n">axis</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">handles</span><span class="o">=</span><span class="n">patches</span><span class="p">)</span>

        <span class="n">x_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_as_label</span><span class="p">(</span><span class="n">column_for_x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_visualize</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">y_labels</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">overlay</span><span class="p">,</span> <span class="n">draw</span><span class="p">,</span> <span class="n">_vertical_x</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_visualize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">y_labels</span><span class="p">,</span> <span class="n">ticks</span><span class="p">,</span> <span class="n">overlay</span><span class="p">,</span> <span class="n">draw</span><span class="p">,</span> <span class="n">annotate</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generic visualization that overlays or separates the draw function.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: The Table contains non-numerical values in columns</span>
<span class="sd">            other than `column_for_categories`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">y_labels</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Real</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="n">label</span><span class="p">]):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The column &#39;</span><span class="si">{0}</span><span class="s2">&#39; contains non-numerical &quot;</span>
                    <span class="s2">&quot;values. A plot cannot be drawn for this column.&quot;</span>
                    <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">label</span><span class="p">))</span>

        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_labels</span><span class="p">)</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">islice</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">cycle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chart_colors</span><span class="p">),</span> <span class="n">n</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">overlay</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">x_label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">axis</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">y_labels</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
                <span class="n">draw</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ticks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">annotate</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">ticks</span><span class="p">)</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">y_labels</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
            <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">*</span><span class="n">n</span><span class="p">))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">):</span>
                <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">axes</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">axis</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">y_labels</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
                <span class="n">draw</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>
                <span class="n">axis</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">x_label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">axis</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ticks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">annotate</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">ticks</span><span class="p">)</span>
                <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_split_column_and_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_or_label</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the specified column and labels of other columns.&quot;&quot;&quot;</span>
        <span class="n">column</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">column_or_label</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_column</span><span class="p">(</span><span class="n">column_or_label</span><span class="p">)</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">label</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">)</span> <span class="k">if</span> <span class="n">column_or_label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">label</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">column</span><span class="p">,</span> <span class="n">labels</span>

    <span class="c1"># Deprecated</span>
<div class="viewcode-block" id="Table.pivot_hist"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.pivot_hist.html#datascience.tables.Table.pivot_hist">[docs]</a>    <span class="k">def</span> <span class="nf">pivot_hist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pivot_column_label</span><span class="p">,</span> <span class="n">value_column_label</span><span class="p">,</span> <span class="n">overlay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="o">**</span><span class="n">vargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Draw histograms of each category in a column. (Deprecated)&quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;pivot_hist is deprecated; use &quot;</span>
                      <span class="s2">&quot;hist(value_column_label, group=pivot_column_label), or &quot;</span>
                      <span class="s2">&quot;with side_by_side=True if you really want side-by-side &quot;</span>
                      <span class="s2">&quot;bars.&quot;</span><span class="p">)</span>
        <span class="n">pvt_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">pivot_column_label</span><span class="p">])</span>
        <span class="n">pvt_columns</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">[</span><span class="n">value_column_label</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">pivot_column_label</span><span class="p">]</span> <span class="o">==</span> <span class="n">pivot</span><span class="p">)]</span> <span class="k">for</span> <span class="n">pivot</span> <span class="ow">in</span> <span class="n">pvt_labels</span><span class="p">]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pvt_labels</span><span class="p">)</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">islice</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">cycle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chart_colors</span><span class="p">),</span> <span class="n">n</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">overlay</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">))</span>
            <span class="n">vals</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">pvt_columns</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="o">**</span><span class="n">vargs</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">pvt_labels</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">*</span> <span class="n">n</span><span class="p">))</span>
            <span class="n">vals</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">bins</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">axis</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">pvt_labels</span><span class="p">,</span> <span class="n">pvt_columns</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                    <span class="n">avals</span><span class="p">,</span> <span class="n">abins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">axis</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="o">**</span><span class="n">vargs</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">avals</span><span class="p">,</span> <span class="n">abins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">axis</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="o">**</span><span class="n">vargs</span><span class="p">)</span>
                <span class="n">axis</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
                <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">avals</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                    <span class="n">bins</span> <span class="o">=</span> <span class="n">abins</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="n">bins</span><span class="o">.</span><span class="n">all</span><span class="p">()</span> <span class="o">==</span> <span class="n">abins</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span> <span class="s2">&quot;Inconsistent bins in hist&quot;</span>
        <span class="n">t</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)()</span>
        <span class="n">t</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bins</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">t</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bins</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">pvt_labels</span><span class="p">,</span><span class="n">vals</span><span class="p">):</span>
            <span class="n">t</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">column</span></div>

<div class="viewcode-block" id="Table.hist"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.hist.html#datascience.tables.Table.hist">[docs]</a>    <span class="k">def</span> <span class="nf">hist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">columns</span><span class="p">,</span> <span class="n">overlay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bin_column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">counts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">side_by_side</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">left_end</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">right_end</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="o">**</span><span class="n">vargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plots one histogram for each column in columns. If no column is</span>
<span class="sd">        specified, plot all columns.</span>

<span class="sd">        Kwargs:</span>
<span class="sd">            overlay (bool): If True, plots 1 chart with all the histograms</span>
<span class="sd">                overlaid on top of each other (instead of the default behavior</span>
<span class="sd">                of one histogram for each column in the table). Also adds a</span>
<span class="sd">                legend that matches each bar color to its column.  Note that</span>
<span class="sd">                if the histograms are not overlaid, they are not forced to the</span>
<span class="sd">                same scale.</span>

<span class="sd">            bins (list or int): Lower bound for each bin in the</span>
<span class="sd">                histogram or number of bins. If None, bins will</span>
<span class="sd">                be chosen automatically.</span>

<span class="sd">            bin_column (column name or index): A column of bin lower bounds.</span>
<span class="sd">                All other columns are treated as counts of these bins.</span>
<span class="sd">                If None, each value in each row is assigned a count of 1.</span>

<span class="sd">            counts (column name or index): Deprecated name for bin_column.</span>

<span class="sd">            unit (string): A name for the units of the plotted column (e.g.</span>
<span class="sd">                &#39;kg&#39;), to be used in the plot.</span>

<span class="sd">            group (column name or index): A column of categories.  The rows are</span>
<span class="sd">                grouped by the values in this column, and a separate histogram is</span>
<span class="sd">                generated for each group.  The histograms are overlaid or plotted</span>
<span class="sd">                separately depending on the overlay argument.  If None, no such</span>
<span class="sd">                grouping is done.</span>

<span class="sd">            side_by_side (bool): Whether histogram bins should be plotted side by</span>
<span class="sd">                side (instead of directly overlaid).  Makes sense only when</span>
<span class="sd">                plotting multiple histograms, either by passing several columns</span>
<span class="sd">                or by using the group option.</span>

<span class="sd">            left_end (int or float) and right_end (int or float): (Not supported </span>
<span class="sd">                for overlayed histograms) The left and right edges of the shading of </span>
<span class="sd">                the histogram. If only one of these is None, then that property </span>
<span class="sd">                will be treated as the extreme edge of the histogram. If both are </span>
<span class="sd">                left None, then no shading will occur.</span>


<span class="sd">            vargs: Additional arguments that get passed into :func:plt.hist.</span>
<span class="sd">                See http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.hist</span>
<span class="sd">                for additional arguments that can be passed into vargs. These</span>
<span class="sd">                include: `range`, `normed`/`density`, `cumulative`, and</span>
<span class="sd">                `orientation`, to name a few.</span>

<span class="sd">        &gt;&gt;&gt; t = Table().with_columns(</span>
<span class="sd">        ...     &#39;count&#39;,  make_array(9, 3, 3, 1),</span>
<span class="sd">        ...     &#39;points&#39;, make_array(1, 2, 2, 10))</span>
<span class="sd">        &gt;&gt;&gt; t</span>
<span class="sd">        count | points</span>
<span class="sd">        9     | 1</span>
<span class="sd">        3     | 2</span>
<span class="sd">        3     | 2</span>
<span class="sd">        1     | 10</span>
<span class="sd">        &gt;&gt;&gt; t.hist() # doctest: +SKIP</span>
<span class="sd">        &lt;histogram of values in count&gt;</span>
<span class="sd">        &lt;histogram of values in points&gt;</span>

<span class="sd">        &gt;&gt;&gt; t = Table().with_columns(</span>
<span class="sd">        ...     &#39;value&#39;,      make_array(101, 102, 103),</span>
<span class="sd">        ...     &#39;proportion&#39;, make_array(0.25, 0.5, 0.25))</span>
<span class="sd">        &gt;&gt;&gt; t.hist(bin_column=&#39;value&#39;) # doctest: +SKIP</span>
<span class="sd">        &lt;histogram of values weighted by corresponding proportions&gt;</span>

<span class="sd">        &gt;&gt;&gt; t = Table().with_columns(</span>
<span class="sd">        ...     &#39;value&#39;,    make_array(1,   2,   3,   2,   5  ),</span>
<span class="sd">        ...     &#39;category&#39;, make_array(&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;b&#39;, &#39;b&#39;))</span>
<span class="sd">        &gt;&gt;&gt; t.hist(&#39;value&#39;, group=&#39;category&#39;) # doctest: +SKIP</span>
<span class="sd">        &lt;two overlaid histograms of the data [1, 2, 3] and [2, 5]&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">counts</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">bin_column</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;counts arg of hist is deprecated; use bin_column&quot;</span><span class="p">)</span>
            <span class="n">bin_column</span><span class="o">=</span><span class="n">counts</span>
        <span class="k">if</span> <span class="n">columns</span><span class="p">:</span>
            <span class="n">columns_included</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">bin_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">columns_included</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bin_column</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">group</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">columns_included</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
            <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="o">*</span><span class="n">columns_included</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">group</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">bin_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Using bin_column and group together is &quot;</span>
                                 <span class="s2">&quot;currently unsupported.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Using group with multiple histogram value &quot;</span>
                                 <span class="s2">&quot;columns is currently unsupported.&quot;</span><span class="p">)</span>

        <span class="c1"># Check for non-numerical values and raise a ValueError if any found</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">col</span> <span class="o">!=</span> <span class="n">group</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">flexible</span><span class="p">)</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The column &#39;</span><span class="si">{0}</span><span class="s2">&#39; contains non-numerical &quot;</span>
                    <span class="s2">&quot;values. A histogram cannot be drawn for this table.&quot;</span>
                    <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">col</span><span class="p">))</span>


        <span class="k">if</span> <span class="n">bin_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">bins</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">bin_column</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">bins</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">vargs</span><span class="p">[</span><span class="s1">&#39;bins&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bins</span>

        <span class="c1"># Matplotlib has deprecated the normed keyword.</span>
        <span class="c1"># TODO consider changing this function to use density= instead too</span>
        <span class="k">if</span> <span class="s1">&#39;normed&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">vargs</span> <span class="ow">and</span> <span class="s1">&#39;density&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">vargs</span><span class="p">:</span>
            <span class="n">vargs</span><span class="p">[</span><span class="s1">&#39;density&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="s1">&#39;normed&#39;</span> <span class="ow">in</span> <span class="n">vargs</span> <span class="ow">and</span> <span class="s1">&#39;density&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">vargs</span><span class="p">:</span>
            <span class="n">vargs</span><span class="p">[</span><span class="s1">&#39;density&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;normed&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s1">&#39;normed&#39;</span> <span class="ow">in</span> <span class="n">vargs</span> <span class="ow">and</span> <span class="s1">&#39;density&#39;</span> <span class="ow">in</span> <span class="n">vargs</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;You can&#39;t specify both normed and density. &quot;</span>
                             <span class="s2">&quot;Use one or the other.&quot;</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">prepare_hist_with_bin_column</span><span class="p">(</span><span class="n">bin_column</span><span class="p">):</span>
            <span class="c1"># This code is factored as a function for clarity only.</span>
            <span class="n">weight_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="k">if</span> <span class="n">c</span> <span class="o">!=</span> <span class="n">bin_column</span><span class="p">]</span>
            <span class="n">bin_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">bin_column</span><span class="p">)</span>
            <span class="n">values_dict</span> <span class="o">=</span> <span class="p">[(</span><span class="n">w</span><span class="p">[:</span><span class="o">-</span><span class="mi">6</span><span class="p">]</span> <span class="k">if</span> <span class="n">w</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39; count&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">w</span><span class="p">,</span> <span class="p">(</span><span class="n">bin_values</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">w</span><span class="p">)))</span> \
                <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">weight_columns</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">values_dict</span>

        <span class="k">def</span> <span class="nf">prepare_hist_with_group</span><span class="p">(</span><span class="n">group</span><span class="p">):</span>
            <span class="c1"># This code is factored as a function for clarity only.</span>
            <span class="n">grouped</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">grouped</span><span class="o">.</span><span class="n">num_rows</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;It looks like you&#39;re making a grouped histogram with &quot;</span>
                              <span class="s2">&quot;a lot of groups (</span><span class="si">{:d}</span><span class="s2">), which is probably incorrect.&quot;</span>
                              <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">num_rows</span><span class="p">))</span>
            <span class="k">return</span> <span class="p">[(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">k</span><span class="p">),</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],))</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">grouped</span><span class="o">.</span><span class="n">index_by</span><span class="p">(</span><span class="n">group</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>

        <span class="c1"># Populate values_dict: An ordered dict from column name to singleton</span>
        <span class="c1"># tuple of array of values or a (values, weights) pair of arrays.  If</span>
        <span class="c1"># any values have weights, they all must have weights.</span>
        <span class="k">if</span> <span class="n">bin_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">values_dict</span> <span class="o">=</span> <span class="n">prepare_hist_with_bin_column</span><span class="p">(</span><span class="n">bin_column</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">group</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">values_dict</span> <span class="o">=</span> <span class="n">prepare_hist_with_group</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">values_dict</span> <span class="o">=</span> <span class="p">[(</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">k</span><span class="p">),))</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">]</span>
        <span class="n">values_dict</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">(</span><span class="n">values_dict</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">left_end</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">right_end</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">left_end</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">bins</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">bins</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="n">left_end</span> <span class="o">=</span> <span class="n">bins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">left_end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">k</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">)])</span>
            <span class="k">elif</span> <span class="n">right_end</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">bins</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">bins</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">right_end</span> <span class="o">=</span> <span class="n">bins</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">right_end</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">k</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">)])</span>

        <span class="k">def</span> <span class="nf">draw_hist</span><span class="p">(</span><span class="n">values_dict</span><span class="p">):</span>
            <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">printoptions</span><span class="p">(</span><span class="n">legacy</span><span class="o">=</span><span class="s1">&#39;1.13&#39;</span><span class="p">):</span>
                <span class="c1"># This code is factored as a function for clarity only.</span>
                <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">values_dict</span><span class="p">)</span>
                <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">rgb_color</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default_alpha</span><span class="p">,)</span> <span class="k">for</span> <span class="n">rgb_color</span> <span class="ow">in</span>
                    <span class="n">itertools</span><span class="o">.</span><span class="n">islice</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">cycle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chart_colors</span><span class="p">),</span> <span class="n">n</span><span class="p">)]</span>
                <span class="n">hist_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">values_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
                <span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Weights were provided for some columns, but not &quot;</span>
                                     <span class="s2">&quot; all, and that&#39;s not supported.&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">vargs</span><span class="p">[</span><span class="s1">&#39;density&#39;</span><span class="p">]:</span>
                    <span class="n">y_label</span> <span class="o">=</span> <span class="s1">&#39;Percent per &#39;</span> <span class="o">+</span> <span class="p">(</span><span class="n">unit</span> <span class="k">if</span> <span class="n">unit</span> <span class="k">else</span> <span class="s1">&#39;unit&#39;</span><span class="p">)</span>
                    <span class="n">percentage</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{:g}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">x</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">y_label</span> <span class="o">=</span> <span class="s1">&#39;Count&#39;</span>

                <span class="k">if</span> <span class="n">overlay</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="c1"># Reverse because legend prints bottom-to-top</span>
                    <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">weights</span> <span class="o">=</span> <span class="n">weights</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">colors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">colors</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span> <span class="o">==</span> <span class="n">n</span><span class="p">:</span>
                        <span class="n">vargs</span><span class="p">[</span><span class="s1">&#39;weights&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">weights</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">side_by_side</span><span class="p">:</span>
                        <span class="n">vargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;histtype&#39;</span><span class="p">,</span> <span class="s1">&#39;stepfilled&#39;</span><span class="p">)</span>
                    <span class="n">figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">))</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="o">**</span><span class="n">vargs</span><span class="p">)</span>
                    <span class="n">axis</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="n">get_axes</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">_vertical_x</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
                    <span class="n">axis</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">vargs</span><span class="p">[</span><span class="s1">&#39;density&#39;</span><span class="p">]:</span>
                        <span class="n">axis</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">percentage</span><span class="p">)</span>
                    <span class="n">x_unit</span> <span class="o">=</span> <span class="s1">&#39; (&#39;</span> <span class="o">+</span> <span class="n">unit</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span> <span class="k">if</span> <span class="n">unit</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
                    <span class="k">if</span> <span class="n">group</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="c1">#There&#39;s a grouping in place but we&#39;re only plotting one column&#39;s values</span>
                        <span class="n">label_not_grouped</span> <span class="o">=</span> <span class="p">[</span><span class="n">l</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="k">if</span> <span class="n">l</span> <span class="o">!=</span> <span class="n">group</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">axis</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">label_not_grouped</span> <span class="o">+</span> <span class="n">x_unit</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>    
                        <span class="n">axis</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_unit</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">hist_names</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
                    <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">_</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">*</span> <span class="n">n</span><span class="p">))</span>
                    <span class="k">if</span> <span class="s1">&#39;bins&#39;</span> <span class="ow">in</span> <span class="n">vargs</span><span class="p">:</span>
                        <span class="n">bins</span> <span class="o">=</span> <span class="n">vargs</span><span class="p">[</span><span class="s1">&#39;bins&#39;</span><span class="p">]</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">)</span> <span class="ow">and</span> <span class="n">bins</span> <span class="o">&gt;</span> <span class="mi">76</span> <span class="ow">or</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="s1">&#39;__len__&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">76</span><span class="p">:</span>
                            <span class="c1"># Use stepfilled when there are too many bins</span>
                            <span class="n">vargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;histtype&#39;</span><span class="p">,</span> <span class="s1">&#39;stepfilled&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">axes</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">hist_name</span><span class="p">,</span> <span class="n">values_for_hist</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">hist_names</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">colors</span><span class="p">)):</span>
                        <span class="n">axis</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">vargs</span><span class="p">[</span><span class="s1">&#39;density&#39;</span><span class="p">]:</span>
                            <span class="n">axis</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">percentage</span><span class="p">)</span>
                        <span class="n">x_unit</span> <span class="o">=</span> <span class="s1">&#39; (&#39;</span> <span class="o">+</span> <span class="n">unit</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span> <span class="k">if</span> <span class="n">unit</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span> <span class="o">==</span> <span class="n">n</span><span class="p">:</span>
                            <span class="n">vargs</span><span class="p">[</span><span class="s1">&#39;weights&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">weights</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                        <span class="n">axis</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">hist_name</span> <span class="o">+</span> <span class="n">x_unit</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
                        <span class="n">heights</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">axis</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">values_for_hist</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="o">**</span><span class="n">vargs</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">left_end</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">right_end</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">x_shade</span><span class="p">,</span> <span class="n">height_shade</span><span class="p">,</span> <span class="n">width_shade</span> <span class="o">=</span> <span class="n">_compute_shading</span><span class="p">(</span><span class="n">heights</span><span class="p">,</span> <span class="n">bins</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">left_end</span><span class="p">,</span> <span class="n">right_end</span><span class="p">)</span>
                            <span class="n">axis</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x_shade</span><span class="p">,</span> <span class="n">height_shade</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width_shade</span><span class="p">,</span>
                                     <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">chart_colors</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;edge&quot;</span><span class="p">)</span>
                        <span class="n">_vertical_x</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
                        <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>

        <span class="n">draw_hist</span><span class="p">(</span><span class="n">values_dict</span><span class="p">)</span></div>

<div class="viewcode-block" id="Table.hist_of_counts"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.hist_of_counts.html#datascience.tables.Table.hist_of_counts">[docs]</a>    <span class="k">def</span> <span class="nf">hist_of_counts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">columns</span><span class="p">,</span> <span class="n">overlay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bin_column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">group</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">side_by_side</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="o">**</span><span class="n">vargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots one count-based histogram for each column in columns. The</span>
<span class="sd">        heights of each bar will represent the counts, and all the bins</span>
<span class="sd">        must be of equal size.</span>

<span class="sd">        If no column is specified, plot all columns.</span>

<span class="sd">        Kwargs:</span>
<span class="sd">            overlay (bool): If True, plots 1 chart with all the histograms</span>
<span class="sd">                overlaid on top of each other (instead of the default behavior</span>
<span class="sd">                of one histogram for each column in the table). Also adds a</span>
<span class="sd">                legend that matches each bar color to its column.  Note that</span>
<span class="sd">                if the histograms are not overlaid, they are not forced to the</span>
<span class="sd">                same scale.</span>

<span class="sd">            bins (array or int): Lower bound for each bin in the</span>
<span class="sd">                histogram or number of bins. If None, bins will</span>
<span class="sd">                be chosen automatically.</span>

<span class="sd">            bin_column (column name or index): A column of bin lower bounds.</span>
<span class="sd">                All other columns are treated as counts of these bins.</span>
<span class="sd">                If None, each value in each row is assigned a count of 1.</span>

<span class="sd">            group (column name or index): A column of categories.  The rows are</span>
<span class="sd">                grouped by the values in this column, and a separate histogram is</span>
<span class="sd">                generated for each group.  The histograms are overlaid or plotted</span>
<span class="sd">                separately depending on the overlay argument.  If None, no such</span>
<span class="sd">                grouping is done.</span>

<span class="sd">            side_by_side (bool): Whether histogram bins should be plotted side by</span>
<span class="sd">                side (instead of directly overlaid).  Makes sense only when</span>
<span class="sd">                plotting multiple histograms, either by passing several columns</span>
<span class="sd">                or by using the group option.</span>

<span class="sd">            vargs: Additional arguments that get passed into :func:plt.hist.</span>
<span class="sd">                See http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.hist</span>
<span class="sd">                for additional arguments that can be passed into vargs. These</span>
<span class="sd">                include: `range`, `cumulative`, and</span>
<span class="sd">                `orientation`, to name a few.</span>

<span class="sd">        &gt;&gt;&gt; t = Table().with_columns(</span>
<span class="sd">        ...     &#39;count&#39;,  make_array(9, 3, 3, 1),</span>
<span class="sd">        ...     &#39;points&#39;, make_array(1, 2, 2, 10))</span>
<span class="sd">        &gt;&gt;&gt; t</span>
<span class="sd">        count | points</span>
<span class="sd">        9     | 1</span>
<span class="sd">        3     | 2</span>
<span class="sd">        3     | 2</span>
<span class="sd">        1     | 10</span>
<span class="sd">        &gt;&gt;&gt; t.hist_of_counts() # doctest: +SKIP</span>
<span class="sd">        &lt;histogram of values in count with counts on y-axis&gt;</span>
<span class="sd">        &lt;histogram of values in points with counts on y-axis&gt;</span>

<span class="sd">        &gt;&gt;&gt; t = Table().with_columns(</span>
<span class="sd">        ...     &#39;value&#39;, make_array(101, 102, 103),</span>
<span class="sd">        ...     &#39;count&#39;, make_array(5, 10, 5))</span>
<span class="sd">        &gt;&gt;&gt; t.hist_of_counts(bin_column=&#39;value&#39;) # doctest: +SKIP</span>
<span class="sd">        &lt;histogram of values weighted by corresponding counts&gt;</span>

<span class="sd">        &gt;&gt;&gt; t = Table().with_columns(</span>
<span class="sd">        ...     &#39;value&#39;,    make_array(1,   2,   3,   2,   5  ),</span>
<span class="sd">        ...     &#39;category&#39;, make_array(&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;b&#39;, &#39;b&#39;))</span>
<span class="sd">        &gt;&gt;&gt; t.hist(&#39;value&#39;, group=&#39;category&#39;) # doctest: +SKIP</span>
<span class="sd">        &lt;two overlaid histograms of the data [1, 2, 3] and [2, 5]&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">bin_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">bins</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">bin_column</span><span class="p">))</span>
            <span class="c1"># TODO ensure counts are integers even when `columns` is empty</span>
            <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">_is_array_integer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">column</span><span class="p">)):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;The column </span><span class="si">{0}</span><span class="s1"> contains non-integer values &#39;</span>
                                     <span class="s1">&#39;When using hist_of_counts with bin_columns, &#39;</span>
                                     <span class="s1">&#39;all columns should contain counts.&#39;</span>
                                     <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">column</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">vargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;normed&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span> <span class="ow">or</span> <span class="n">vargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;density&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;hist_of_counts is for displaying counts only, &quot;</span>
                             <span class="s2">&quot;and should not be used with the normed or &quot;</span>
                             <span class="s2">&quot;density keyword arguments&quot;</span><span class="p">)</span>
        <span class="n">vargs</span><span class="p">[</span><span class="s1">&#39;density&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">bins</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;bins must have at least two items&quot;</span><span class="p">)</span>
            <span class="n">diffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">bins</span><span class="p">))</span>
            <span class="c1"># Diffs should all be equal (up to floating point error)</span>
            <span class="n">normalized_diff_deviances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">diffs</span> <span class="o">-</span> <span class="n">diffs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">diffs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">normalized_diff_deviances</span> <span class="o">&gt;</span> <span class="mf">1e-11</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Bins of unequal size should not be used &quot;</span>
                                 <span class="s2">&quot;with hist_of_counts. Please use hist() and &quot;</span>
                                 <span class="s2">&quot;make sure to set normed=True&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="o">*</span><span class="n">columns</span><span class="p">,</span> <span class="n">overlay</span><span class="o">=</span><span class="n">overlay</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">bin_column</span><span class="o">=</span><span class="n">bin_column</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">,</span> <span class="n">side_by_side</span><span class="o">=</span><span class="n">side_by_side</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span> <span class="o">**</span><span class="n">vargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Table.boxplot"><a class="viewcode-back" href="../../_autosummary/datascience.tables.Table.boxplot.html#datascience.tables.Table.boxplot">[docs]</a>    <span class="k">def</span> <span class="nf">boxplot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">vargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plots a boxplot for the table.</span>

<span class="sd">        Every column must be numerical.</span>

<span class="sd">        Kwargs:</span>
<span class="sd">            vargs: Additional arguments that get passed into `plt.boxplot`.</span>
<span class="sd">                See http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.boxplot</span>
<span class="sd">                for additional arguments that can be passed into vargs. These include</span>
<span class="sd">                `vert` and `showmeans`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: The Table contains columns with non-numerical values.</span>

<span class="sd">        &gt;&gt;&gt; table = Table().with_columns(</span>
<span class="sd">        ...     &#39;test1&#39;, make_array(92.5, 88, 72, 71, 99, 100, 95, 83, 94, 93),</span>
<span class="sd">        ...     &#39;test2&#39;, make_array(89, 84, 74, 66, 92, 99, 88, 81, 95, 94))</span>
<span class="sd">        &gt;&gt;&gt; table</span>
<span class="sd">        test1 | test2</span>
<span class="sd">        92.5  | 89</span>
<span class="sd">        88    | 84</span>
<span class="sd">        72    | 74</span>
<span class="sd">        71    | 66</span>
<span class="sd">        99    | 92</span>
<span class="sd">        100   | 99</span>
<span class="sd">        95    | 88</span>
<span class="sd">        83    | 81</span>
<span class="sd">        94    | 95</span>
<span class="sd">        93    | 94</span>
<span class="sd">        &gt;&gt;&gt; table.boxplot() # doctest: +SKIP</span>
<span class="sd">        &lt;boxplot of test1 and boxplot of test2 side-by-side on the same figure&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check for non-numerical values and raise a ValueError if any found</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">flexible</span><span class="p">)</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The column &#39;</span><span class="si">{0}</span><span class="s2">&#39; contains non-numerical &quot;</span>
                    <span class="s2">&quot;values. A histogram cannot be drawn for this table.&quot;</span>
                    <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">col</span><span class="p">))</span>

        <span class="n">columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">vargs</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">columns</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="n">values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="o">**</span><span class="n">vargs</span><span class="p">)</span></div>


    <span class="c1">###########</span>
    <span class="c1"># Support #</span>
    <span class="c1">###########</span>

    <span class="k">class</span> <span class="nc">Row</span><span class="p">(</span><span class="nb">tuple</span><span class="p">):</span>
        <span class="n">_table</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Set by subclasses in Rows</span>

        <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_label</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_table</span><span class="o">.</span><span class="n">column_index</span><span class="p">(</span><span class="n">column_label</span><span class="p">)]</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span> <span class="c1">#adding support for NumPy v1.18.0 as per changes in https://github.com/numpy/numpy/pull/14745</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;Attribute (</span><span class="si">{0}</span><span class="s2">) not found in row.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">column_label</span><span class="p">))</span>

        <span class="k">def</span> <span class="nf">item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index_or_label</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Return the item at an index or label.&quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index_or_label</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">):</span>
                <span class="n">index</span> <span class="o">=</span> <span class="n">index_or_label</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table</span><span class="o">.</span><span class="n">column_index</span><span class="p">(</span><span class="n">index_or_label</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

        <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="s1">&#39;Row(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">=</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_table</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">v</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">())</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span>

        <span class="k">def</span> <span class="nf">asdict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_table</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="bp">self</span><span class="p">))</span>

    <span class="k">class</span> <span class="nc">Rows</span><span class="p">(</span><span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;An iterable view over the rows in a table.&quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_table</span> <span class="o">=</span> <span class="n">table</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">*</span><span class="n">i</span><span class="o">.</span><span class="n">indices</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))))</span>

            <span class="n">labels</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_table</span><span class="o">.</span><span class="n">labels</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">labels</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span> <span class="o">=</span> <span class="n">labels</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_row</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="s1">&#39;Row&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">Table</span><span class="o">.</span><span class="n">Row</span><span class="p">,</span> <span class="p">),</span> <span class="nb">dict</span><span class="p">(</span><span class="n">_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_table</span><span class="p">))</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_row</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table</span><span class="o">.</span><span class="n">_columns</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

        <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table</span><span class="o">.</span><span class="n">num_rows</span>

        <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">(</span><span class="si">{1}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_table</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">_is_array_integer</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns True if an array contains integers (integer type or near-int</span>
<span class="sd">    float values) and False otherwise.</span>

<span class="sd">    &gt;&gt;&gt; _is_array_integer(np.arange(10))</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; _is_array_integer(np.arange(7.0, 20.0, 1.0))</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; _is_array_integer(np.arange(0, 1, 0.1))</span>
<span class="sd">    False</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">arr</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">_zero_on_type_error</span><span class="p">(</span><span class="n">column_fn</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Wrap a function on an np.ndarray to return 0 on a type error.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">column_fn</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">column_fn</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">callable</span><span class="p">(</span><span class="n">column_fn</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;column functions must be callable&#39;</span><span class="p">)</span>
    <span class="nd">@functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">column_fn</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">wrapped</span><span class="p">(</span><span class="n">column</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">column_fn</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">column</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span><span class="p">()</span> <span class="c1"># A typed zero value</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span>
    <span class="k">return</span> <span class="n">wrapped</span>

<span class="k">def</span> <span class="nf">_compute_shading</span><span class="p">(</span><span class="n">heights</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">left_end</span><span class="p">,</span> <span class="n">right_end</span><span class="p">):</span>
    <span class="n">shade_start_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">bins</span> <span class="o">&lt;=</span> <span class="n">left_end</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">initial</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">shade_end_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">bins</span> <span class="o">&lt;</span> <span class="n">right_end</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">initial</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="c1"># x_shade are the bin starts, so ignore bins[-1], which is the RHS of the last bin</span>
    <span class="n">x_shade</span> <span class="o">=</span> <span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">shade_start_idx</span><span class="p">:</span><span class="n">shade_end_idx</span><span class="p">]</span>
    <span class="n">height_shade</span> <span class="o">=</span> <span class="n">heights</span><span class="p">[</span><span class="n">shade_start_idx</span><span class="p">:</span><span class="n">shade_end_idx</span><span class="p">]</span>
    <span class="n">width_shade</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">bins</span><span class="p">[</span><span class="n">shade_start_idx</span><span class="p">:(</span><span class="n">shade_end_idx</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span>

    <span class="k">if</span> <span class="n">left_end</span> <span class="o">&gt;</span> <span class="n">x_shade</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="c1"># shrink the width by the unshaded area, then move the bin start</span>
        <span class="n">width_shade</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="p">(</span><span class="n">left_end</span> <span class="o">-</span> <span class="n">x_shade</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">x_shade</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">left_end</span>

    <span class="n">original_ending</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_shade</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">width_shade</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">right_end</span> <span class="o">&lt;</span> <span class="n">original_ending</span><span class="p">:</span>
        <span class="n">width_shade</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="p">(</span><span class="n">original_ending</span> <span class="o">-</span> <span class="n">right_end</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x_shade</span><span class="p">,</span> <span class="n">height_shade</span><span class="p">,</span> <span class="n">width_shade</span>


<span class="k">def</span> <span class="nf">_fill_with_zeros</span><span class="p">(</span><span class="n">partials</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">zero</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Find and return values from rows for all partials. In cases where no</span>
<span class="sd">    row matches a partial, zero is assumed as value. For a row, the first</span>
<span class="sd">    (n-1) fields are assumed to be the partial, and the last field,</span>
<span class="sd">    the value, where n is the total number of fields in each row. It is</span>
<span class="sd">    assumed that there is a unique row for each partial.</span>
<span class="sd">    partials -- single field values or tuples of field values</span>
<span class="sd">    rows -- table rows</span>
<span class="sd">    zero -- value used when no rows match a particular partial</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_is_non_string_iterable</span><span class="p">(</span><span class="n">partials</span><span class="p">):</span>
        <span class="c1"># Convert partials to tuple for comparison against row slice later</span>
        <span class="n">partials</span> <span class="o">=</span> <span class="p">[(</span><span class="n">partial</span><span class="p">,)</span> <span class="k">for</span> <span class="n">partial</span> <span class="ow">in</span> <span class="n">partials</span><span class="p">]</span>

    <span class="c1"># Construct mapping of partials to values in rows</span>
    <span class="n">mapping</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
        <span class="n">mapping</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">row</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">zero</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Try to infer zero from given row values.</span>
        <span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">mapping</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">zero</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">partial</span><span class="p">,</span> <span class="n">zero</span><span class="p">)</span> <span class="k">for</span> <span class="n">partial</span> <span class="ow">in</span> <span class="n">partials</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">_as_labels</span><span class="p">(</span><span class="n">column_or_columns</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return a list of labels for a label or labels.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_is_non_string_iterable</span><span class="p">(</span><span class="n">column_or_columns</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">column_or_columns</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">column_or_columns</span>

<span class="k">def</span> <span class="nf">_varargs_labels_as_list</span><span class="p">(</span><span class="n">label_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return a list of labels for a list of labels or singleton list of list</span>
<span class="sd">    of labels.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">label_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">_is_non_string_iterable</span><span class="p">(</span><span class="n">label_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="c1"># Assume everything is a label.  If not, it&#39;ll be caught later.</span>
        <span class="k">return</span> <span class="n">label_list</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">label_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">label_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Labels </span><span class="si">{}</span><span class="s2"> contain more than list.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">label_list</span><span class="p">),</span>
                         <span class="s2">&quot;Pass just one list of labels.&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_assert_same</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Assert that all values are identical and return the unique value.&quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
    <span class="n">first</span><span class="p">,</span> <span class="n">rest</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">rest</span><span class="p">:</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">v</span> <span class="o">==</span> <span class="n">first</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">pandas</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="ow">and</span> <span class="n">pandas</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">first</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">first</span>


<span class="k">def</span> <span class="nf">_collected_label</span><span class="p">(</span><span class="n">collect</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Label of a collected column.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">collect</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;&lt;&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">label</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">collect</span><span class="o">.</span><span class="vm">__name__</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">label</span>


<span class="k">def</span> <span class="nf">_is_non_string_iterable</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Whether a value is iterable.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;__iter__&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>

<span class="k">def</span> <span class="nf">_vertical_x</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_width</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Switch labels to vertical if they are long.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ticks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ticks</span> <span class="o">=</span> <span class="n">axis</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">()</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">rint</span><span class="p">(</span><span class="n">ticks</span><span class="p">))</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
        <span class="n">ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rint</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">tick</span><span class="p">))</span> <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">ticks</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">max_width</span><span class="p">:</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">ticks</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>

<span class="c1">###################</span>
<span class="c1"># Slicing support #</span>
<span class="c1">###################</span>

<span class="k">class</span> <span class="nc">_RowSelector</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">abc</span><span class="o">.</span><span class="n">ABCMeta</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_table</span> <span class="o">=</span> <span class="n">table</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row_numbers_or_slice</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">args</span><span class="p">:</span>
            <span class="n">all_args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
            <span class="n">all_args</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">row_numbers_or_slice</span><span class="p">)</span>
            <span class="n">all_args</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">all_args</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">all_args</span> <span class="o">=</span> <span class="n">row_numbers_or_slice</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">all_args</span><span class="p">)</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">_RowTaker</span><span class="p">(</span><span class="n">_RowSelector</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row_indices_or_slice</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a new Table with selected rows taken by index.</span>

<span class="sd">        Args:</span>
<span class="sd">            ``row_indices_or_slice`` (integer or array of integers):</span>
<span class="sd">            The row index, list of row indices or a slice of row indices to</span>
<span class="sd">            be selected.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A new instance of ``Table`` with selected rows in order</span>
<span class="sd">            corresponding to ``row_indices_or_slice``.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ``IndexError``, if any ``row_indices_or_slice`` is out of bounds</span>
<span class="sd">            with respect to column length.</span>

<span class="sd">        &gt;&gt;&gt; grades = Table().with_columns(&#39;letter grade&#39;,</span>
<span class="sd">        ...     make_array(&#39;A+&#39;, &#39;A&#39;, &#39;A-&#39;, &#39;B+&#39;, &#39;B&#39;, &#39;B-&#39;),</span>
<span class="sd">        ...     &#39;gpa&#39;, make_array(4, 4, 3.7, 3.3, 3, 2.7))</span>
<span class="sd">        &gt;&gt;&gt; grades</span>
<span class="sd">        letter grade | gpa</span>
<span class="sd">        A+           | 4</span>
<span class="sd">        A            | 4</span>
<span class="sd">        A-           | 3.7</span>
<span class="sd">        B+           | 3.3</span>
<span class="sd">        B            | 3</span>
<span class="sd">        B-           | 2.7</span>
<span class="sd">        &gt;&gt;&gt; grades.take(0)</span>
<span class="sd">        letter grade | gpa</span>
<span class="sd">        A+           | 4</span>
<span class="sd">        &gt;&gt;&gt; grades.take(-1)</span>
<span class="sd">        letter grade | gpa</span>
<span class="sd">        B-           | 2.7</span>
<span class="sd">        &gt;&gt;&gt; grades.take(make_array(2, 1, 0))</span>
<span class="sd">        letter grade | gpa</span>
<span class="sd">        A-           | 3.7</span>
<span class="sd">        A            | 4</span>
<span class="sd">        A+           | 4</span>
<span class="sd">        &gt;&gt;&gt; grades.take[:3]</span>
<span class="sd">        letter grade | gpa</span>
<span class="sd">        A+           | 4</span>
<span class="sd">        A            | 4</span>
<span class="sd">        A-           | 3.7</span>
<span class="sd">        &gt;&gt;&gt; grades.take(np.arange(0,3))</span>
<span class="sd">        letter grade | gpa</span>
<span class="sd">        A+           | 4</span>
<span class="sd">        A            | 4</span>
<span class="sd">        A-           | 3.7</span>
<span class="sd">        &gt;&gt;&gt; grades.take(0, 2)</span>
<span class="sd">        letter grade | gpa</span>
<span class="sd">        A+           | 4</span>
<span class="sd">        A-           | 3.7</span>
<span class="sd">        &gt;&gt;&gt; grades.take(10)</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        IndexError: index 10 is out of bounds for axis 0 with size 6</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">row_indices_or_slice</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Iterable</span><span class="p">):</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">row_indices_or_slice</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                       <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table</span><span class="o">.</span><span class="n">_columns</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table</span><span class="o">.</span><span class="n">_with_columns</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>

        <span class="n">rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="n">row_indices_or_slice</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">Table</span><span class="o">.</span><span class="n">Row</span><span class="p">):</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="p">[</span><span class="n">rows</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table</span><span class="o">.</span><span class="n">_with_columns</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">rows</span><span class="p">))</span>


<span class="k">class</span> <span class="nc">_RowExcluder</span><span class="p">(</span><span class="n">_RowSelector</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row_indices_or_slice</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a new Table without a sequence of rows excluded by number.</span>

<span class="sd">        Args:</span>
<span class="sd">            ``row_indices_or_slice`` (integer or list of integers or slice):</span>
<span class="sd">                The row index, list of row indices or a slice of row indices</span>
<span class="sd">                to be excluded.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A new instance of ``Table``.</span>

<span class="sd">        &gt;&gt;&gt; t = Table().with_columns(</span>
<span class="sd">        ...     &#39;letter grade&#39;, make_array(&#39;A+&#39;, &#39;A&#39;, &#39;A-&#39;, &#39;B+&#39;, &#39;B&#39;, &#39;B-&#39;),</span>
<span class="sd">        ...     &#39;gpa&#39;, make_array(4, 4, 3.7, 3.3, 3, 2.7))</span>
<span class="sd">        &gt;&gt;&gt; t</span>
<span class="sd">        letter grade | gpa</span>
<span class="sd">        A+           | 4</span>
<span class="sd">        A            | 4</span>
<span class="sd">        A-           | 3.7</span>
<span class="sd">        B+           | 3.3</span>
<span class="sd">        B            | 3</span>
<span class="sd">        B-           | 2.7</span>
<span class="sd">        &gt;&gt;&gt; t.exclude(4)</span>
<span class="sd">        letter grade | gpa</span>
<span class="sd">        A+           | 4</span>
<span class="sd">        A            | 4</span>
<span class="sd">        A-           | 3.7</span>
<span class="sd">        B+           | 3.3</span>
<span class="sd">        B-           | 2.7</span>
<span class="sd">        &gt;&gt;&gt; t.exclude(-1)</span>
<span class="sd">        letter grade | gpa</span>
<span class="sd">        A+           | 4</span>
<span class="sd">        A            | 4</span>
<span class="sd">        A-           | 3.7</span>
<span class="sd">        B+           | 3.3</span>
<span class="sd">        B            | 3</span>
<span class="sd">        &gt;&gt;&gt; t.exclude(make_array(1, 3, 4))</span>
<span class="sd">        letter grade | gpa</span>
<span class="sd">        A+           | 4</span>
<span class="sd">        A-           | 3.7</span>
<span class="sd">        B-           | 2.7</span>
<span class="sd">        &gt;&gt;&gt; t.exclude(range(3))</span>
<span class="sd">        letter grade | gpa</span>
<span class="sd">        B+           | 3.3</span>
<span class="sd">        B            | 3</span>
<span class="sd">        B-           | 2.7</span>
<span class="sd">        &gt;&gt;&gt; t.exclude(0, 2)</span>
<span class="sd">        letter grade | gpa</span>
<span class="sd">        A            | 4</span>
<span class="sd">        B+           | 3.3</span>
<span class="sd">        B            | 3</span>
<span class="sd">        B-           | 2.7</span>

<span class="sd">        Note that ``exclude`` also supports NumPy-like indexing and slicing:</span>

<span class="sd">        &gt;&gt;&gt; t.exclude[:3]</span>
<span class="sd">        letter grade | gpa</span>
<span class="sd">        B+           | 3.3</span>
<span class="sd">        B            | 3</span>
<span class="sd">        B-           | 2.7</span>

<span class="sd">        &gt;&gt;&gt; t.exclude[1, 3, 4]</span>
<span class="sd">        letter grade | gpa</span>
<span class="sd">        A+           | 4</span>
<span class="sd">        A-           | 3.7</span>
<span class="sd">        B-           | 2.7</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">row_indices_or_slice</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Iterable</span><span class="p">):</span>
            <span class="n">without_row_indices</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">row_indices_or_slice</span><span class="p">)</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span> <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_table</span><span class="o">.</span><span class="n">rows</span><span class="p">[:])</span>
                    <span class="k">if</span> <span class="n">index</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">without_row_indices</span><span class="p">]</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table</span><span class="o">.</span><span class="n">_with_columns</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">rows</span><span class="p">))</span>

        <span class="n">row_slice</span> <span class="o">=</span> <span class="n">row_indices_or_slice</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">row_slice</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="n">row_slice</span> <span class="o">%=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table</span><span class="o">.</span><span class="n">num_rows</span>
            <span class="n">row_slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">row_slice</span><span class="p">,</span> <span class="n">row_slice</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_table</span><span class="o">.</span><span class="n">rows</span><span class="p">[:</span><span class="n">row_slice</span><span class="o">.</span><span class="n">start</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">],</span>
                               <span class="bp">self</span><span class="o">.</span><span class="n">_table</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="n">row_slice</span><span class="o">.</span><span class="n">stop</span><span class="p">:])</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table</span><span class="o">.</span><span class="n">_with_columns</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">rows</span><span class="p">))</span>

<span class="c1"># For Sphinx: grab the docstrings from `Taker.__getitem__` and `Withouter.__getitem__`</span>
<span class="n">Table</span><span class="o">.</span><span class="n">take</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">_RowTaker</span><span class="o">.</span><span class="fm">__getitem__</span><span class="o">.</span><span class="vm">__doc__</span>
<span class="n">Table</span><span class="o">.</span><span class="n">exclude</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">_RowExcluder</span><span class="o">.</span><span class="fm">__getitem__</span><span class="o">.</span><span class="vm">__doc__</span>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">datascience 0.15.7 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">datascience.tables</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2015, John DeNero, David Culler, Alvin Wan, and Sam Lau.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.1.1.
    </div>
  </body>
</html>